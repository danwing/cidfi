<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Framework for CID Flow Indicator (CIDFI)</title>
<meta content="Dan Wing" name="author">
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Mohamed Boucadair" name="author">
<meta content="
       Host-to-network signaling and network-to-host signaling can improve
the user experience to adapt to network's constraints and share expected application needs, and thus to provide
differentiated service to a flow and to packets within a flow. The differentiated service may be provided at the network (e.g., packet prioritization), the server (e.g., adaptive transmission), or both. 
       This document describes how clients can communicate with their nearby
network elements so their QUIC streams can be augmented with
information about network conditions and packet importance to meet both
intentional and reactive management policies.  With
optional server support individual packets can receive differentiated
service. The proposed approach covers both directions of a flow. 
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="user experience" name="keyword">
<meta content="bandwidth" name="keyword">
<meta content="priority" name="keyword">
<meta content="enriched feedback" name="keyword">
<meta content="media streaming" name="keyword">
<meta content="realtime media" name="keyword">
<meta content="QoS" name="keyword">
<meta content="5G" name="keyword">
<meta content="Wi-Fi" name="keyword">
<meta content="WiFi" name="keyword">
<meta content="DTLS Connection Identifier" name="keyword">
<meta content="DTLS-SRTP" name="keyword">
<meta content="QUIC Connection Identifier" name="keyword">
<meta content="QUIC" name="keyword">
<meta content="draft-wing-cidfi-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.11.6
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.1.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.12
-->
<link href="draft-wing-cidfi.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CIDFI</td>
<td class="right">December 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wing, et al.</td>
<td class="center">Expires 13 June 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wing-cidfi-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-12-11" class="published">11 December 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-06-13">13 June 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Cloud Software Group</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Framework for CID Flow Indicator (CIDFI)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Host-to-network signaling and network-to-host signaling can improve
the user experience to adapt to network's constraints and share expected application needs, and thus to provide
differentiated service to a flow and to packets within a flow. The differentiated service may be provided at the network (e.g., packet prioritization), the server (e.g., adaptive transmission), or both.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document describes how clients can communicate with their nearby
network elements so their QUIC streams can be augmented with
information about network conditions and packet importance to meet both
intentional and reactive management policies.  With
optional server support individual packets can receive differentiated
service. The proposed approach covers both directions of a flow.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://danwing.github.io/cidfi/draft-wing-cidfi.html">https://danwing.github.io/cidfi/draft-wing-cidfi.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wing-cidfi/">https://datatracker.ietf.org/doc/draft-wing-cidfi/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        TSV Area Working Group mailing list (<span><a href="mailto:tsvwg@ietf.org">mailto:tsvwg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tsvwg/">https://www.ietf.org/mailman/listinfo/tsvwg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/danwing/cidfi">https://github.com/danwing/cidfi</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 June 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-operation-with-streaming-vi" class="internal xref">Operation with Streaming Video</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-operation-with-interactive-" class="internal xref">Operation with Interactive Audio/Video/Screen sharing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-notations" class="internal xref">Notations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-design-goals" class="internal xref">Design Goals</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-network-configuration-to-su" class="internal xref">Network Configuration to Support CIDFI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-dns-svcb-records" class="internal xref">DNS SVCB Records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-provisioning-domains" class="internal xref">Provisioning Domains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-dhcp-or-3gpp-pco" class="internal xref">DHCP or 3GPP PCO</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-client-operation-on-network" class="internal xref">Client Operation on Network Attach or Topology Change</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-client-learns-local-network" class="internal xref">Client Learns Local Network Supports CIDFI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-client-learns-using-dns-svc" class="internal xref">Client Learns Using DNS SVCB</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-client-learns-using-provisi" class="internal xref">Client Learns Using Provisioning Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-client-learns-using-dhcp-or" class="internal xref">Client Learns Using DHCP or 3GPP PCO</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-client-authorizes-cidfi-awa" class="internal xref">Client Authorizes CIDFI-aware Network Elements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-client-operation-on-each-co" class="internal xref">Client Operation on Each Connection to a Server</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-client-learns-server-suppor" class="internal xref">Client Learns Server Supports CIDFI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-client-proves-ownership-of-" class="internal xref">Client Proves Ownership of its UDP 4-Tuple</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-stun-cidfi-nonce-attribute" class="internal xref">STUN CIDFI-NONCE Attribute</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-initial-metadata-exchange" class="internal xref">Initial Metadata Exchange</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-host-to-network-signaling" class="internal xref">Host to Network Signaling</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-network-to-host-signaling" class="internal xref">Network to Host Signaling</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-ongoing-signaling" class="internal xref">Ongoing Signaling</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-interaction-with-load-balan" class="internal xref">Interaction with Load Balancers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-topology-change" class="internal xref">Topology Change</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-details-of-metadata-exchang" class="internal xref">Details of Metadata Exchanged</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-server-to-cidfi-aware-netwo" class="internal xref">Server to CIDFI-aware Network Element</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="auto internal xref">11.1.1</a>.  <a href="#name-mapping-metadata-parameters" class="internal xref">Mapping Metadata Parameters to DCIDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-11.1.2" class="auto internal xref">11.1.2</a>.  <a href="#name-mapping-diffserv-code-point" class="internal xref">Mapping DiffServ Code Point (DSCP) to DCIDs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-cidfi-aware-network-element" class="internal xref">CIDFI-aware Network Element to Server</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-privacy-aware-metadata-shar" class="internal xref">Privacy-Aware Metadata Sharing in Network Relationships</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-discussion-points" class="internal xref">Discussion Points</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-client-versus-server-signal" class="internal xref">Client versus Server Signaling CID-to-importance Mapping</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-overhead-of-quic-dcid-packe" class="internal xref">Overhead of QUIC DCID Packet Examination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-interaction-with-wi-fi-pack" class="internal xref">Interaction with Wi-Fi Packet Aggregation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-overhead-of-mapping-cids-to" class="internal xref">Overhead of Mapping CIDs to Packet Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-improve-cidfi-initializatio" class="internal xref">Improve CIDFI Initialization Time</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-primary-quic-channel-cid-ch" class="internal xref">Primary QUIC Channel CID Change</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-state-maintenance" class="internal xref">State Maintenance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-api-integration-for-quic-st" class="internal xref">API Integration for QUIC Stream and Packet-Level Prioritization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref">17.1</a>.  <a href="#name-new-quic-transport-paramete" class="internal xref">New QUIC Transport Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref">17.2</a>.  <a href="#name-new-well-known-uri-cidfi-aw" class="internal xref">New Well-known URI "cidfi-aware"</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#section-17.3" class="auto internal xref">17.3</a>.  <a href="#name-new-special-use-domain-name" class="internal xref">New Special-use Domain Name</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#section-17.4" class="auto internal xref">17.4</a>.  <a href="#name-new-dns-service-binding-svc" class="internal xref">New DNS Service Binding (SVCB)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#section-17.5" class="auto internal xref">17.5</a>.  <a href="#name-new-stun-attribute" class="internal xref">New STUN Attribute</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6">
                <p id="section-toc.1-1.17.2.6.1"><a href="#section-17.6" class="auto internal xref">17.6</a>.  <a href="#name-new-provisioning-domain-add" class="internal xref">New Provisioning Domain Additional Information Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref">18</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="auto internal xref">18.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="auto internal xref">18.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-extending-cidfi-to-other-pr" class="internal xref">Extending CIDFI to Other Protocols</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-dtls" class="internal xref">DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-tcp" class="internal xref">TCP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-sctp" class="internal xref">SCTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4">
                <p id="section-toc.1-1.19.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-rtp-and-srtp" class="internal xref">RTP and SRTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.5">
                <p id="section-toc.1-1.19.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-bespoke-udp-application-pro" class="internal xref">Bespoke UDP Application Protocols</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Senders rely on ramping up their transmission rate until they encounter
packet loss or see <span>[<a href="#ECN" class="cite xref">ECN</a>]</span> indicating they should level off or
slow down their transmission rate.  This feedback takes time and contributes
to poor user experience when the sender over- or under-shoots the actual
available bandwidth, especially if the sender changes fidelity of the
content (e.g., improves video quality which consumes more bandwidth which
then gets dropped by the network).  This is also called an 'intentional
management policy'.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Due to network constraints a network element will need to drop or even
prioritize a packet ahead of other packets within the same UDP 4-tuple. The decision of which packet
to drop or prioritize is improved if the network element knows the
importance of the packet.  By mapping packet metadata to a network-visible
field in each packet, the network element is better informed and better able
to improve the user experience.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">There are also exceptional cases (crisis) where "normal" network
resources cannot be used at maximum and, thus, a network would seek to
reduce or offload some of the traffic during these events -- often
called 'reactive traffic policy'. Network-to-host signals are
useful to put in place adequate traffic distribution policies (e.g.,
prefer the use of alternate paths, offload a network).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><a href="#design-approaches" class="auto internal xref">Figure 1</a> depicts examples of approaches to establish channels to convey
and share metadata between hosts, networks, and servers. This document adheres to
the client-centric metadata sharing approach because it preserves privacy and also
takes advantage of clients having a full view on their available network attachments.
Metadata exchanges can occur in one single direction or both directions of a flows.<a href="#section-1-4" class="pilcrow">¶</a></p>
<span id="name-candidate-design-approaches"></span><div id="design-approaches">
<figure id="figure-1">
        <div id="section-1-5.1">
          <div class="alignCenter art-svg artwork" id="section-1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="672" width="552" viewBox="0 0 552 672" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,80 L 8,112" fill="none" stroke="black"></path>
              <path d="M 8,272 L 8,304" fill="none" stroke="black"></path>
              <path d="M 8,512 L 8,544" fill="none" stroke="black"></path>
              <path d="M 40,112 L 40,192" fill="none" stroke="black"></path>
              <path d="M 40,304 L 40,432" fill="none" stroke="black"></path>
              <path d="M 40,544 L 40,656" fill="none" stroke="black"></path>
              <path d="M 64,80 L 64,112" fill="none" stroke="black"></path>
              <path d="M 64,272 L 64,304" fill="none" stroke="black"></path>
              <path d="M 64,512 L 64,544" fill="none" stroke="black"></path>
              <path d="M 184,64 L 184,88" fill="none" stroke="black"></path>
              <path d="M 184,104 L 184,112" fill="none" stroke="black"></path>
              <path d="M 192,256 L 192,280" fill="none" stroke="black"></path>
              <path d="M 192,296 L 192,304" fill="none" stroke="black"></path>
              <path d="M 208,496 L 208,520" fill="none" stroke="black"></path>
              <path d="M 208,536 L 208,544" fill="none" stroke="black"></path>
              <path d="M 256,128 L 256,192" fill="none" stroke="black"></path>
              <path d="M 264,320 L 264,336" fill="none" stroke="black"></path>
              <path d="M 264,368 L 264,432" fill="none" stroke="black"></path>
              <path d="M 280,560 L 280,624" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,88" fill="none" stroke="black"></path>
              <path d="M 320,104 L 320,112" fill="none" stroke="black"></path>
              <path d="M 328,256 L 328,280" fill="none" stroke="black"></path>
              <path d="M 328,296 L 328,304" fill="none" stroke="black"></path>
              <path d="M 344,496 L 344,520" fill="none" stroke="black"></path>
              <path d="M 344,536 L 344,544" fill="none" stroke="black"></path>
              <path d="M 440,80 L 440,112" fill="none" stroke="black"></path>
              <path d="M 440,272 L 440,304" fill="none" stroke="black"></path>
              <path d="M 456,64 L 456,80" fill="none" stroke="black"></path>
              <path d="M 456,256 L 456,272" fill="none" stroke="black"></path>
              <path d="M 456,512 L 456,544" fill="none" stroke="black"></path>
              <path d="M 472,48 L 472,64" fill="none" stroke="black"></path>
              <path d="M 472,112 L 472,192" fill="none" stroke="black"></path>
              <path d="M 472,240 L 472,256" fill="none" stroke="black"></path>
              <path d="M 472,304 L 472,432" fill="none" stroke="black"></path>
              <path d="M 472,496 L 472,512" fill="none" stroke="black"></path>
              <path d="M 488,480 L 488,496" fill="none" stroke="black"></path>
              <path d="M 488,544 L 488,656" fill="none" stroke="black"></path>
              <path d="M 496,80 L 496,112" fill="none" stroke="black"></path>
              <path d="M 496,272 L 496,304" fill="none" stroke="black"></path>
              <path d="M 512,64 L 512,96" fill="none" stroke="black"></path>
              <path d="M 512,256 L 512,288" fill="none" stroke="black"></path>
              <path d="M 512,512 L 512,544" fill="none" stroke="black"></path>
              <path d="M 520,368 L 520,384" fill="none" stroke="black"></path>
              <path d="M 528,48 L 528,80" fill="none" stroke="black"></path>
              <path d="M 528,240 L 528,272" fill="none" stroke="black"></path>
              <path d="M 528,496 L 528,528" fill="none" stroke="black"></path>
              <path d="M 544,480 L 544,512" fill="none" stroke="black"></path>
              <path d="M 200,48 L 304,48" fill="none" stroke="black"></path>
              <path d="M 472,48 L 528,48" fill="none" stroke="black"></path>
              <path d="M 456,64 L 512,64" fill="none" stroke="black"></path>
              <path d="M 8,80 L 64,80" fill="none" stroke="black"></path>
              <path d="M 440,80 L 496,80" fill="none" stroke="black"></path>
              <path d="M 512,80 L 528,80" fill="none" stroke="black"></path>
              <path d="M 64,96 L 440,96" fill="none" stroke="black"></path>
              <path d="M 496,96 L 512,96" fill="none" stroke="black"></path>
              <path d="M 8,112 L 64,112" fill="none" stroke="black"></path>
              <path d="M 440,112 L 496,112" fill="none" stroke="black"></path>
              <path d="M 200,128 L 304,128" fill="none" stroke="black"></path>
              <path d="M 48,158 L 72,158" fill="none" stroke="black"></path>
              <path d="M 48,162 L 72,162" fill="none" stroke="black"></path>
              <path d="M 224,158 L 248,158" fill="none" stroke="black"></path>
              <path d="M 224,162 L 248,162" fill="none" stroke="black"></path>
              <path d="M 264,158 L 288,158" fill="none" stroke="black"></path>
              <path d="M 264,162 L 288,162" fill="none" stroke="black"></path>
              <path d="M 440,158 L 464,158" fill="none" stroke="black"></path>
              <path d="M 440,162 L 464,162" fill="none" stroke="black"></path>
              <path d="M 208,240 L 312,240" fill="none" stroke="black"></path>
              <path d="M 472,240 L 528,240" fill="none" stroke="black"></path>
              <path d="M 456,256 L 512,256" fill="none" stroke="black"></path>
              <path d="M 8,272 L 64,272" fill="none" stroke="black"></path>
              <path d="M 440,272 L 496,272" fill="none" stroke="black"></path>
              <path d="M 512,272 L 528,272" fill="none" stroke="black"></path>
              <path d="M 64,288 L 440,288" fill="none" stroke="black"></path>
              <path d="M 496,288 L 512,288" fill="none" stroke="black"></path>
              <path d="M 8,304 L 64,304" fill="none" stroke="black"></path>
              <path d="M 440,304 L 496,304" fill="none" stroke="black"></path>
              <path d="M 208,320 L 312,320" fill="none" stroke="black"></path>
              <path d="M 48,352 L 88,352" fill="none" stroke="black"></path>
              <path d="M 416,352 L 464,352" fill="none" stroke="black"></path>
              <path d="M 480,352 L 504,352" fill="none" stroke="black"></path>
              <path d="M 48,400 L 64,400" fill="none" stroke="black"></path>
              <path d="M 240,400 L 256,400" fill="none" stroke="black"></path>
              <path d="M 272,400 L 312,400" fill="none" stroke="black"></path>
              <path d="M 400,400 L 464,400" fill="none" stroke="black"></path>
              <path d="M 480,400 L 504,400" fill="none" stroke="black"></path>
              <path d="M 224,480 L 328,480" fill="none" stroke="black"></path>
              <path d="M 488,480 L 544,480" fill="none" stroke="black"></path>
              <path d="M 472,496 L 528,496" fill="none" stroke="black"></path>
              <path d="M 8,512 L 64,512" fill="none" stroke="black"></path>
              <path d="M 456,512 L 512,512" fill="none" stroke="black"></path>
              <path d="M 528,512 L 544,512" fill="none" stroke="black"></path>
              <path d="M 64,528 L 456,528" fill="none" stroke="black"></path>
              <path d="M 512,528 L 528,528" fill="none" stroke="black"></path>
              <path d="M 8,544 L 64,544" fill="none" stroke="black"></path>
              <path d="M 456,544 L 512,544" fill="none" stroke="black"></path>
              <path d="M 224,560 L 328,560" fill="none" stroke="black"></path>
              <path d="M 48,592 L 120,592" fill="none" stroke="black"></path>
              <path d="M 208,592 L 272,592" fill="none" stroke="black"></path>
              <path d="M 48,638 L 64,638" fill="none" stroke="black"></path>
              <path d="M 48,642 L 64,642" fill="none" stroke="black"></path>
              <path d="M 464,638 L 480,638" fill="none" stroke="black"></path>
              <path d="M 464,642 L 480,642" fill="none" stroke="black"></path>
              <path d="M 200,48 C 191.16936,48 184,55.16936 184,64" fill="none" stroke="black"></path>
              <path d="M 304,48 C 312.83064,48 320,55.16936 320,64" fill="none" stroke="black"></path>
              <path d="M 200,128 C 191.16936,128 184,120.83064 184,112" fill="none" stroke="black"></path>
              <path d="M 304,128 C 312.83064,128 320,120.83064 320,112" fill="none" stroke="black"></path>
              <path d="M 208,240 C 199.16936,240 192,247.16936 192,256" fill="none" stroke="black"></path>
              <path d="M 312,240 C 320.83064,240 328,247.16936 328,256" fill="none" stroke="black"></path>
              <path d="M 208,320 C 199.16936,320 192,312.83064 192,304" fill="none" stroke="black"></path>
              <path d="M 312,320 C 320.83064,320 328,312.83064 328,304" fill="none" stroke="black"></path>
              <path d="M 504,352 C 512.83064,352 520,359.16936 520,368" fill="none" stroke="black"></path>
              <path d="M 504,400 C 512.83064,400 520,392.83064 520,384" fill="none" stroke="black"></path>
              <path d="M 224,480 C 215.16936,480 208,487.16936 208,496" fill="none" stroke="black"></path>
              <path d="M 328,480 C 336.83064,480 344,487.16936 344,496" fill="none" stroke="black"></path>
              <path d="M 224,560 C 215.16936,560 208,552.83064 208,544" fill="none" stroke="black"></path>
              <path d="M 328,560 C 336.83064,560 344,552.83064 344,544" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="488,640 476,634.4 476,645.6" fill="black" transform="rotate(0,480,640)"></polygon>
              <polygon class="arrowhead" points="488,400 476,394.4 476,405.6" fill="black" transform="rotate(180,480,400)"></polygon>
              <polygon class="arrowhead" points="488,352 476,346.4 476,357.6" fill="black" transform="rotate(180,480,352)"></polygon>
              <polygon class="arrowhead" points="472,400 460,394.4 460,405.6" fill="black" transform="rotate(0,464,400)"></polygon>
              <polygon class="arrowhead" points="472,352 460,346.4 460,357.6" fill="black" transform="rotate(0,464,352)"></polygon>
              <polygon class="arrowhead" points="472,160 460,154.4 460,165.6" fill="black" transform="rotate(0,464,160)"></polygon>
              <path class="jump" d="M 344,536 C 338,536 338,520 344,520" fill="none" stroke="black"></path>
              <path class="jump" d="M 328,296 C 322,296 322,280 328,280" fill="none" stroke="black"></path>
              <path class="jump" d="M 320,104 C 314,104 314,88 320,88" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="280,592 268,586.4 268,597.6" fill="black" transform="rotate(0,272,592)"></polygon>
              <polygon class="arrowhead" points="280,400 268,394.4 268,405.6" fill="black" transform="rotate(180,272,400)"></polygon>
              <polygon class="arrowhead" points="272,160 260,154.4 260,165.6" fill="black" transform="rotate(180,264,160)"></polygon>
              <polygon class="arrowhead" points="264,400 252,394.4 252,405.6" fill="black" transform="rotate(0,256,400)"></polygon>
              <polygon class="arrowhead" points="256,160 244,154.4 244,165.6" fill="black" transform="rotate(0,248,160)"></polygon>
              <path class="jump" d="M 208,536 C 214,536 214,520 208,520" fill="none" stroke="black"></path>
              <path class="jump" d="M 192,296 C 198,296 198,280 192,280" fill="none" stroke="black"></path>
              <path class="jump" d="M 184,104 C 190,104 190,88 184,88" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="56,640 44,634.4 44,645.6" fill="black" transform="rotate(180,48,640)"></polygon>
              <polygon class="arrowhead" points="56,592 44,586.4 44,597.6" fill="black" transform="rotate(180,48,592)"></polygon>
              <polygon class="arrowhead" points="56,400 44,394.4 44,405.6" fill="black" transform="rotate(180,48,400)"></polygon>
              <polygon class="arrowhead" points="56,352 44,346.4 44,357.6" fill="black" transform="rotate(180,48,352)"></polygon>
              <polygon class="arrowhead" points="56,160 44,154.4 44,165.6" fill="black" transform="rotate(180,48,160)"></polygon>
              <g class="text">
                <text x="16" y="36">(1)</text>
                <text x="72" y="36">Proxied</text>
                <text x="148" y="36">Connection</text>
                <text x="252" y="84">Network(s)</text>
                <text x="36" y="100">Client</text>
                <text x="468" y="100">Server</text>
                <text x="92" y="164">User</text>
                <text x="168" y="164">Data+Metadata</text>
                <text x="308" y="164">User</text>
                <text x="384" y="164">Data+Metadata</text>
                <text x="92" y="180">Secure</text>
                <text x="164" y="180">Connection</text>
                <text x="216" y="180">1</text>
                <text x="308" y="180">Secure</text>
                <text x="380" y="180">Connection</text>
                <text x="432" y="180">2</text>
                <text x="16" y="228">(2)</text>
                <text x="88" y="228">Out-of-band</text>
                <text x="172" y="228">Metadata</text>
                <text x="240" y="228">Sharing</text>
                <text x="260" y="276">Network(s)</text>
                <text x="36" y="292">Client</text>
                <text x="468" y="292">Server</text>
                <text x="132" y="356">End-to-End</text>
                <text x="204" y="356">Secure</text>
                <text x="276" y="356">Connection</text>
                <text x="328" y="356">+</text>
                <text x="356" y="356">User</text>
                <text x="396" y="356">Data</text>
                <text x="500" y="372">GLUE</text>
                <text x="496" y="388">CXs</text>
                <text x="108" y="404">Metadata</text>
                <text x="188" y="404">(Optional)</text>
                <text x="356" y="404">Metadata</text>
                <text x="100" y="420">Secure</text>
                <text x="172" y="420">Connection</text>
                <text x="224" y="420">1</text>
                <text x="324" y="420">Secure</text>
                <text x="396" y="420">Connection</text>
                <text x="448" y="420">2</text>
                <text x="16" y="468">(3)</text>
                <text x="100" y="468">Client-centric</text>
                <text x="196" y="468">Metadata</text>
                <text x="264" y="468">Sharing</text>
                <text x="276" y="516">Network(s)</text>
                <text x="36" y="532">Client</text>
                <text x="484" y="532">Server</text>
                <text x="164" y="596">Metadata</text>
                <text x="132" y="612">Secure</text>
                <text x="204" y="612">Connection</text>
                <text x="116" y="644">End-to-End</text>
                <text x="188" y="644">Secure</text>
                <text x="260" y="644">Connection</text>
                <text x="324" y="644">User</text>
                <text x="400" y="644">Data+Metadata</text>
                <text x="280" y="660">|</text>
              </g>
            </svg><a href="#section-1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-candidate-design-approaches" class="selfRef">Candidate Design Approaches</a>
        </figcaption></figure>
</div>
<p id="section-1-6">The document is a generic framework that would function in any network deployment. This framework can be leveraged by any transport protocol (see <a href="#extending" class="auto internal xref">Appendix A</a>). To illustrate the framework's applicability this document focuses on QUIC transport.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">This document defines CIDFI (pronounced "sid fye") which is a system
of several protocols that allow communicating about a <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>
connection from the network to the server and the server to the network.
The information exchanged allows the server to know about network conditions
and allows the server to signal packet importance. The following main steps
are involved in CIDFI; some of them are optional:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1">CIDFI-awareness discovery between a host and a network.<a href="#section-2-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.2">
          <p id="section-2-2.2.1">Establishment of a secure association with all or a subset of CIDFI-aware
networks.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.3">
          <p id="section-2-2.3.1">Negotiation of CIDFI support with remote servers.<a href="#section-2-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.4">
          <p id="section-2-2.4.1">CIDFI-aware networks sharing of changes of network conditions.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.5">
          <p id="section-2-2.5.1">CIDFI-aware clients sharing of metadata with CIDFI-aware networks as hints
to help processing flows.<a href="#section-2-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.6">
          <p id="section-2-2.6.1">CIDFI-aware clients sharing of metadata with CIDFI-aware server to adapt
to local network conditions.<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-3">CIDFI does not require that all these steps are enabled. Incremental
deployments may be envisaged (e.g., network and client support, network, client,
and server support). Differentiated service can
be provided to a flow, packets within a flow, or a combination thereof as a function
of the CIDFI support by various involved entities. For example, a CIDFI-aware network
might share signals with clients that would then trigger locally connection migration or relay
the information to the server (if it is CIDFI-aware) to adjust its sending behavior
by avoiding aggressive use of local resources or using alternate paths. <a href="#metadata-exchanged" class="auto internal xref">Section 11</a>
further elaborates on the differentiated service that can be provided by enabling CIDFI.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><a href="#fig-arch" class="auto internal xref">Figure 2</a> provides a sample network diagram of a CIDFI system showing two
bandwidth-constrained networks (or links) depicted by "B" and
CIDFI-aware devices immediately upstream of those links, and another
bandwidth-constrained link between a smartphone handset and its Radio
Access Network (RAN).  This diagram shows the same protocol and same mechanism
can operate with or without 5G, and can operate with different administrative
domains such as Wi-Fi, an ISP edge router, and a 5G RAN.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">For the sake of illustration, <a href="#fig-arch" class="auto internal xref">Figure 2</a> simplifies the representation
of the various involved network segments. It also assumes that multiple
server instances are enabled in the server network but the document
does not make any assumption about the internal structure of the service
nor how a flow is processed by or steered to a service instance. However,
CIDFI includes provisions to ensure that the service instance that is
selected to service a client request is the same instance that will
receive CIDFI metadata for that client.<a href="#section-2-5" class="pilcrow">¶</a></p>
<span id="name-network-diagram"></span><div id="fig-arch">
<figure id="figure-2">
        <div id="section-2-6.1">
          <div class="alignCenter art-svg artwork" id="section-2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="560" viewBox="0 0 560 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,112" fill="none" stroke="black"></path>
              <path d="M 8,176 L 8,256" fill="none" stroke="black"></path>
              <path d="M 64,48 L 64,112" fill="none" stroke="black"></path>
              <path d="M 88,176 L 88,256" fill="none" stroke="black"></path>
              <path d="M 96,48 L 96,144" fill="none" stroke="black"></path>
              <path d="M 152,48 L 152,144" fill="none" stroke="black"></path>
              <path d="M 168,32 L 168,80" fill="none" stroke="black"></path>
              <path d="M 168,112 L 168,216" fill="none" stroke="black"></path>
              <path d="M 168,232 L 168,304" fill="none" stroke="black"></path>
              <path d="M 184,48 L 184,128" fill="none" stroke="black"></path>
              <path d="M 184,176 L 184,256" fill="none" stroke="black"></path>
              <path d="M 240,48 L 240,128" fill="none" stroke="black"></path>
              <path d="M 240,176 L 240,256" fill="none" stroke="black"></path>
              <path d="M 264,80 L 264,112" fill="none" stroke="black"></path>
              <path d="M 264,208 L 264,240" fill="none" stroke="black"></path>
              <path d="M 320,80 L 320,112" fill="none" stroke="black"></path>
              <path d="M 320,208 L 320,240" fill="none" stroke="black"></path>
              <path d="M 344,32 L 344,88" fill="none" stroke="black"></path>
              <path d="M 344,104 L 344,216" fill="none" stroke="black"></path>
              <path d="M 344,232 L 344,304" fill="none" stroke="black"></path>
              <path d="M 360,144 L 360,176" fill="none" stroke="black"></path>
              <path d="M 376,96 L 376,144" fill="none" stroke="black"></path>
              <path d="M 376,176 L 376,224" fill="none" stroke="black"></path>
              <path d="M 416,144 L 416,176" fill="none" stroke="black"></path>
              <path d="M 432,32 L 432,152" fill="none" stroke="black"></path>
              <path d="M 432,168 L 432,304" fill="none" stroke="black"></path>
              <path d="M 448,112 L 448,192" fill="none" stroke="black"></path>
              <path d="M 464,96 L 464,112" fill="none" stroke="black"></path>
              <path d="M 480,80 L 480,96" fill="none" stroke="black"></path>
              <path d="M 520,112 L 520,192" fill="none" stroke="black"></path>
              <path d="M 536,96 L 536,160" fill="none" stroke="black"></path>
              <path d="M 552,80 L 552,144" fill="none" stroke="black"></path>
              <path d="M 8,48 L 64,48" fill="none" stroke="black"></path>
              <path d="M 96,48 L 152,48" fill="none" stroke="black"></path>
              <path d="M 184,48 L 240,48" fill="none" stroke="black"></path>
              <path d="M 264,80 L 320,80" fill="none" stroke="black"></path>
              <path d="M 480,80 L 552,80" fill="none" stroke="black"></path>
              <path d="M 240,96 L 264,96" fill="none" stroke="black"></path>
              <path d="M 320,96 L 376,96" fill="none" stroke="black"></path>
              <path d="M 464,96 L 536,96" fill="none" stroke="black"></path>
              <path d="M 8,112 L 64,112" fill="none" stroke="black"></path>
              <path d="M 264,112 L 320,112" fill="none" stroke="black"></path>
              <path d="M 448,112 L 520,112" fill="none" stroke="black"></path>
              <path d="M 184,128 L 240,128" fill="none" stroke="black"></path>
              <path d="M 96,144 L 152,144" fill="none" stroke="black"></path>
              <path d="M 360,144 L 416,144" fill="none" stroke="black"></path>
              <path d="M 536,144 L 552,144" fill="none" stroke="black"></path>
              <path d="M 416,160 L 448,160" fill="none" stroke="black"></path>
              <path d="M 520,160 L 536,160" fill="none" stroke="black"></path>
              <path d="M 8,176 L 88,176" fill="none" stroke="black"></path>
              <path d="M 184,176 L 240,176" fill="none" stroke="black"></path>
              <path d="M 360,176 L 416,176" fill="none" stroke="black"></path>
              <path d="M 448,192 L 520,192" fill="none" stroke="black"></path>
              <path d="M 264,208 L 320,208" fill="none" stroke="black"></path>
              <path d="M 96,224 L 128,224" fill="none" stroke="black"></path>
              <path d="M 144,224 L 184,224" fill="none" stroke="black"></path>
              <path d="M 240,224 L 264,224" fill="none" stroke="black"></path>
              <path d="M 320,224 L 376,224" fill="none" stroke="black"></path>
              <path d="M 264,240 L 320,240" fill="none" stroke="black"></path>
              <path d="M 8,256 L 88,256" fill="none" stroke="black"></path>
              <path d="M 184,256 L 240,256" fill="none" stroke="black"></path>
              <g class="text">
                <text x="36" y="68">CIDFI-</text>
                <text x="124" y="68">CIDFI-</text>
                <text x="212" y="68">CIDFI-</text>
                <text x="32" y="84">aware</text>
                <text x="120" y="84">aware</text>
                <text x="208" y="84">aware</text>
                <text x="36" y="100">client</text>
                <text x="80" y="100">-B-</text>
                <text x="120" y="100">Wi-Fi</text>
                <text x="168" y="100">-B-</text>
                <text x="204" y="100">edge</text>
                <text x="292" y="100">router</text>
                <text x="124" y="116">access</text>
                <text x="212" y="116">router</text>
                <text x="120" y="132">point</text>
                <text x="484" y="132">CIDFI-</text>
                <text x="480" y="148">aware</text>
                <text x="388" y="164">router</text>
                <text x="476" y="164">QUIC</text>
                <text x="484" y="180">server</text>
                <text x="44" y="196">CIDFI-</text>
                <text x="212" y="196">CIDFI-</text>
                <text x="40" y="212">aware</text>
                <text x="208" y="212">aware</text>
                <text x="44" y="228">client</text>
                <text x="136" y="228">B</text>
                <text x="200" y="228">RAN</text>
                <text x="292" y="228">router</text>
                <text x="48" y="244">(handset)</text>
                <text x="212" y="244">router</text>
                <text x="384" y="292">Transit</text>
                <text x="476" y="292">Server</text>
                <text x="44" y="308">User</text>
                <text x="96" y="308">Network</text>
                <text x="216" y="308">ISP</text>
                <text x="264" y="308">Network</text>
                <text x="384" y="308">Network</text>
                <text x="480" y="308">Network</text>
              </g>
            </svg><a href="#section-2-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-network-diagram" class="selfRef">Network Diagram</a>
        </figcaption></figure>
</div>
<p id="section-2-7">The CIDFI-aware client establishes a TLS connection with the
CIDFI-aware network elements (Wi-Fi access point, edge router, and RAN
router in the above diagram).  Over this connection it receives
network performance information (n2h) and it sends mapping of QUIC
Destination CIDs to packet importance (h2n).<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">The design creates new state in the CIDFI-aware network elements for
mapping from Destination CID to the packet metadata and maintaining
triggers to update the client if the network characteristics change,
and to maintain a TLS channel with the client.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9"><a href="#network-to-host" class="auto internal xref">Section 7.3.2</a> describes network-to-host signaling
similar to the use case described in <span><a href="https://datatracker.ietf.org/doc/html/draft-joras-sadcdn-01#section-2" class="relref">Section 2</a> of [<a href="#I-D.joras-sadcdn" class="cite xref">I-D.joras-sadcdn</a>]</span>, with metadata
relaying through the client.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10"><a href="#host-to-network" class="auto internal xref">Section 7.3.1</a> describes host-to-network
metadata signaling similar to the use cases described in <span><a href="https://datatracker.ietf.org/doc/html/draft-joras-sadcdn-01#section-3" class="relref">Section 3</a> of [<a href="#I-D.joras-sadcdn" class="cite xref">I-D.joras-sadcdn</a>]</span>.  The host-to-network metadata signaling can
also benefit <span>[<a href="#I-D.ietf-avtcore-rtp-over-quic" class="cite xref">I-D.ietf-avtcore-rtp-over-quic</a>]</span>.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">CIDFI brings benefits to QUIC as that protocol is of primary interest.
QUIC is quickly replacing HTTPS-over-TCP on many websites and content
delivery networks because of its advantages to both end users and
servers.  CIDFI can bring value to a system comprised solely of a
CIDFI-aware client and the CIDFI-aware network elements.  By adding a
CIDFI-aware server that supports QUIC unreliable datagrams
<span>[<a href="#RFC9221" class="cite xref">RFC9221</a>]</span> and API integration (see <a href="#api-integration" class="auto internal xref">Section 15</a>), each
packet can receive differentiated service from the network.  This is
especially useful during user transitions from a high quality wireless
reception to lower quality reception (e.g., entering a building).
Additionally, CIDFI can be extended to other protocols as discussed in
<a href="#extending" class="auto internal xref">Appendix A</a>.<a href="#section-2-11" class="pilcrow">¶</a></p>
<div id="operation-with-streaming-video">
<section id="section-2.1">
        <h3 id="name-operation-with-streaming-vi">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-operation-with-streaming-vi" class="section-name selfRef">Operation with Streaming Video</a>
        </h3>
<p id="section-2.1-1">Incremental deployment: Streaming video only needs to be transmitted slightly faster than the
video playout rate.  Sending the video significantly faster can waste
bandwidth, most notably if the user abandons the video early.  Worse, as discussed in <span><a href="https://rfc-editor.org/rfc/rfc8517#section-3.10" class="relref">Section 3.10</a> of [<a href="#RFC8517" class="cite xref">RFC8517</a>]</span>, a fast download of a video that won't be viewed completely by the subscriber may lead to quick exhaustion of the user data quota. CIDFI
helps this use-case with its network-to-host signaling which informs
the client of available bandwidth allowing the client to choose
a compatible video stream.  This functionality does not need a CIDFI-
aware server.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Full system deployment: With reliable transport such as TCP, the only purpose of
video key frames is the user scrolling forward/backward.  When
video streaming uses unreliable transport (<span>[<a href="#RFC9221" class="cite xref">RFC9221</a>]</span>)
it is beneficial to differentiate keyframes from predictive
frames on the network especially when the network performs
reactive policy management.  When the server also supports CIDFI,
key frames can be differentiated which improves user experience
during linear playout.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operation-with-interactive-audiovideoscreen-sharing">
<section id="section-2.2">
        <h3 id="name-operation-with-interactive-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-operation-with-interactive-" class="section-name selfRef">Operation with Interactive Audio/Video/Screen sharing</a>
        </h3>
<p id="section-2.2-1">Incremental deployment: With interactive sessions CIDFI can help determine the bandwidth
available for the flow so the video (and screen sharing) quality and
size can be constrained to the available bandwidth.  This benefit
can be deployed locally with a CIDFI-aware client and CIDFI-aware
network.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Full system deployment: When the remote peer also supports CIDFI, the remote peer can
differentiate packets containing audio, video, or screen sharing.  In
certain use-cases audio is the most important whereas in other
use-cases screen sharing is most important.  With CIDFI, the relative
importance of each packet can be differentiated as that relative
importance changes during a session.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The document makes use of the following terms:<a href="#section-3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-3">
        <dt id="section-3-3.1">CID:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.2">
          <p id="section-3-3.2.1">Connection Identifier used by <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.3">CNE:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.4">
          <p id="section-3-3.4.1">CIDFI-aware Network Element, a network element that
supports this CIDFI specification.  This is typically a router.<a href="#section-3-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.5">Differentiated service:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.6">
          <p id="section-3-3.6.1">Refers to a differentiated processing that can be provided to a flow (or specific packets within a flow) by a network, client, or server.<a href="#section-3-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.7"></dt>
        <dd style="margin-left: 1.5em" id="section-3-3.8">
          <p id="section-3-3.8.1">Examples of differentiated service are: prioritization, adaptive transmission, or traffic steering.<a href="#section-3-3.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="notations">
<section id="section-3.1">
        <h3 id="name-notations">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-notations" class="section-name selfRef">Notations</a>
        </h3>
<p id="section-3.1-1">For discussion purposes, JSON is used in the examples to give a flavor of the
data that the client retrieves from a CNE.  The authors
anticipate using a more efficient encoding such as <span>[<a href="#CBOR" class="cite xref">CBOR</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="design-goals">
<section id="section-4">
      <h2 id="name-design-goals">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-design-goals" class="section-name selfRef">Design Goals</a>
      </h2>
<p id="section-4-1">This section highlights the design goals of this specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-2">
        <dt id="section-4-2.1">Client Authorization:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.2">
          <p id="section-4-2.2.1">The client authorizes each CIDFI-aware network element (CNE) to participate in CIDFI
for each QUIC flow.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3">Same Server Instance:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.4">
          <p id="section-4-2.4.1">When the server also participates in CIDFI, the same QUIC connection is used for CIDFI
communication with that server,
which ensures it arrives at the same server instance even in the presence of
network translators (NAT) or server-side ECMP load balancers or server-side CID-aware
load balancers <span>[<a href="#I-D.ietf-quic-load-balancers" class="cite xref">I-D.ietf-quic-load-balancers</a>]</span>.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">Privacy:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.6">
          <p id="section-4-2.6.1">The host-to-network signaling of the mapping from packet metadata to CID is only sent to CIDFI-aware network
elements (CNEs) and is protected by TLS.  The network-to-host signaling of network metadata is protected by TLS.  For
CIDFI to operate, a CNE never needs the server's identity, and a CNE is never provided decryption keys for
the QUIC communication between the client and server.<a href="#section-4-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.7">Integrity:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.8">
          <p id="section-4-2.8.1">Metadata sharing, including the mapping of packet importance to Destination CIDs, are
integrity protected by QUIC itself and cannot be modified by on-path
network elements.  The communication between client, server, and
network elements is protected by TLS.<a href="#section-4-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.9"></dt>
        <dd style="margin-left: 1.5em" id="section-4-2.10">
          <p id="section-4-2.10.1">Packet metadata is communicated over a
TLS-encrypted channel from the CIDFI client to its CIDFI-aware network elements,
and mapped to integrity-protected QUIC CIDs.<a href="#section-4-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.11">Internet Survival:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.12">
          <p id="section-4-2.12.1">The QUIC communications between clients
and servers are not changed so CIDFI is expected to work wherever QUIC
works.  The elements involved are only the QUIC
client and server and with the participating CIDFI-aware network elements.<a href="#section-4-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.13"></dt>
        <dd style="margin-left: 1.5em" id="section-4-2.14">
          <p id="section-4-2.14.1">CIDFI can operate over IPv4, IPv6, IPv4/IPv4 translation (NAT), and IPv6/IPv4
translation (NAT64).<a href="#section-4-2.14.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="network-configuration-to-support-cidfi">
<section id="section-5">
      <h2 id="name-network-configuration-to-su">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-network-configuration-to-su" class="section-name selfRef">Network Configuration to Support CIDFI</a>
      </h2>
<p id="section-5-1">The network is configured to advertise its support for CIDFI.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For this step, four mechanisms are described in this document: DNS
SVCB records <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>, IPv6 Provisioning Domains (PvD) <span>[<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>, DHCP <span>[<a href="#RFC2131" class="cite xref">RFC2131</a>]</span><span>[<a href="#RFC8415" class="cite xref">RFC8415</a>]</span>, and 3GPP PCO.
These are described in the following sub-sections.<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-3.1">
          <p id="section-5-3.1.1">Standardizing all or some of these mechanisms is for further discussion.<a href="#section-5-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="dns-svcb-records">
<section id="section-5.1">
        <h3 id="name-dns-svcb-records">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-dns-svcb-records" class="section-name selfRef">DNS SVCB Records</a>
        </h3>
<p id="section-5.1-1">This document defines a new DNS Service Binding parameter "cidfi-aware" in
<a href="#iana-svcb" class="auto internal xref">Section 17.4</a> and a new Special-Use Domain Name "cidfi.arpa" in
<a href="#iana-sudn" class="auto internal xref">Section 17.3</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The local network is configured to respond to DNS SVCB
<span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> queries with ServiceMode (<span><a href="https://rfc-editor.org/rfc/rfc9460#section-2.4.3" class="relref">Section 2.4.3</a> of [<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>) for "_cidfi-aware.cidfi.arpa" with
the DNS names of that network's and upstream network's CIDFI-aware
network elements (CNEs).  If upstream networks also support CIDFI (e.g., the
ISP network) those SVCB records are aggregated into the local DNS
server's response by the local network's recursive DNS resolvers.  For
example, a query for "_cidfi-aware.cidfi.arpa" might return two answers
for the two CNEs on the local network, one belonging
to the local ISP (example.net) and the other belonging to the local
Wi-Fi network (example.com).<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-example-of-svcb-records"></span><div id="svcb-ex">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-5.1-3.1">
<pre>
_cidfi-aware.cidfi.arpa. 7200 IN SVCB 0 service-cidfi.example.net. (
    alpn=h3 cidfipathauth=/path-auth-query{?cidfi}
    cidfimetadata=/cidfi-metadata
    )
_cidfi-aware.cidfi.arpa. 7200 IN SVCB 0 wifi.example.com. (
    alpn=h3 cidfipathauth=/path-auth-query{?cidfi}
    cidfimetadata=/cidfi-metadata
    )
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-svcb-records" class="selfRef">Example of SVCB Records</a>
          </figcaption></figure>
</div>
<p id="section-5.1-4">When multihoming, the multihome-capable CPE aggregates all upstream
networks' "_cidfi-aware.cidfi.arpa" responses into the response sent to
its locally-connected clients.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="provisioning-domains">
<section id="section-5.2">
        <h3 id="name-provisioning-domains">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-provisioning-domains" class="section-name selfRef">Provisioning Domains</a>
        </h3>
<p id="section-5.2-1">The CIDFI networks are configured to set the H-flag so clients can
request PvD Additional Information (<span><a href="https://rfc-editor.org/rfc/rfc8801#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The "application/pvd+json" returned looks like what is depicted in <a href="#pvd-ex" class="auto internal xref">Figure 4</a> when there are two
CIDFI-aware network elements, service-cidfi and wi-fi.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span id="name-example-of-pvd-information"></span><div id="pvd-ex">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-5.2-3.1">
<pre>
{
   "cidfi":[
      {
         "cidfinode":"service-cidfi.example.net",
         "min-ttl":3,
         "cidfipathauth":"/path-auth-query{?cidfi}",
         "cidfimetadata":"/cidfi-metadata"
      },
      {
         "cidfinode":"wi-fi.example.net",
         "min-ttl":2,
         "cidfipathauth":"/path-auth-query{?cidfi}",
         "cidfimetadata":"/cidfi-metadata"
      }
   ]
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-pvd-information" class="selfRef">Example of PvD Information</a>
          </figcaption></figure>
</div>
<p id="section-5.2-4">Multiple CIDFI-aware network elements on a network path will require
propagating the Provisioning Domain Additional Information.  For
example, a CIDFI-aware Wi-Fi access point connected to a CIDFI-aware
5G network will require the information for both CIDFI networks be available
to the client, in a single Provisioning Domain Additional Information
request.  This means the Wi-Fi access point has to obtain that information
so the Wi-Fi access point can provide both the 5G network's information
and the Wi-Fi access point's information.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dhcp-or-3gpp-pco">
<section id="section-5.3">
        <h3 id="name-dhcp-or-3gpp-pco">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-dhcp-or-3gpp-pco" class="section-name selfRef">DHCP or 3GPP PCO</a>
        </h3>
<p id="section-5.3-1">The network is configured to respond to DHCPv6, DHCPv4 sub-option,
or 3GPP PCO (Protocol Configuration Option) Information Element.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="attach">
<section id="section-6">
      <h2 id="name-client-operation-on-network">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-client-operation-on-network" class="section-name selfRef">Client Operation on Network Attach or Topology Change</a>
      </h2>
<p id="section-6-1">On initial network attach topology change (see <a href="#topology" class="auto internal xref">Section 10</a>),
the client learns if the network supports CIDFI (<a href="#discovery" class="auto internal xref">Section 6.1</a>) and
authorizes discovered network elements (<a href="#client-authorizes" class="auto internal xref">Section 6.2</a>).<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="discovery">
<section id="section-6.1">
        <h3 id="name-client-learns-local-network">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-client-learns-local-network" class="section-name selfRef">Client Learns Local Network Supports CIDFI</a>
        </h3>
<p id="section-6.1-1">For this step, four mechanisms are identified: DNS SVCB records, IPv6
PvD, DHCP, or 3GPP PCO.  These are described
in the following sub-sections.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">In all cases below,<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">if the discovery succeeds (i.e., the client concludes that the local
and/or ISP network support CIDFI) client processing proceeds to
<a href="#client-authorizes" class="auto internal xref">Section 6.2</a>.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">if the discovery failed (i.e., the client concludes that the local
network and ISP do not support CIDFI) client processing stops.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="client-learns-using-dns-svcb">
<section id="section-6.1.1">
          <h4 id="name-client-learns-using-dns-svc">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-client-learns-using-dns-svc" class="section-name selfRef">Client Learns Using DNS SVCB</a>
          </h4>
<p id="section-6.1.1-1">The client determines if the local network provides CIDFI service by
issuing a query to the local DNS server for
"_cidfi-aware.cidfi.arpa." with the SVCB resource record type (64)
<span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-learns-using-provisioning-domain">
<section id="section-6.1.2">
          <h4 id="name-client-learns-using-provisi">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-client-learns-using-provisi" class="section-name selfRef">Client Learns Using Provisioning Domain</a>
          </h4>
<p id="section-6.1.2-1">The client determines if the local network supports CIDFI by
querying https://&lt;PvD-ID&gt;/.well-known/pvd as described in <span><a href="https://rfc-editor.org/rfc/rfc8801#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-learns-using-dhcp-or-3gpp-pco">
<section id="section-6.1.3">
          <h4 id="name-client-learns-using-dhcp-or">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-client-learns-using-dhcp-or" class="section-name selfRef">Client Learns Using DHCP or 3GPP PCO</a>
          </h4>
<p id="section-6.1.3-1">The client determines that a local network is CIDFI-capable if the
client receives an explicit signal from the network, e.g., via a
dedicated DHCP option or a 3GPP PCO (Protocol Configuration Option)
Information Element. An example of explicit signal would be a DHCPv6
option or DHCPv4 sub-option that that is returned as part of
<span>[<a href="#RFC7839" class="cite xref">RFC7839</a>]</span>.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-authorizes">
<section id="section-6.2">
        <h3 id="name-client-authorizes-cidfi-awa">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-client-authorizes-cidfi-awa" class="section-name selfRef">Client Authorizes CIDFI-aware Network Elements</a>
        </h3>
<p id="section-6.2-1">The response from the previous step in <a href="#discovery" class="auto internal xref">Section 6.1</a> will contain one or more
CNEs.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The client authorizes each of the CNEs using
a local policy.  This policy is implementation-specific.  An
implementation example might have the users authorize their ISP's CIDFI server
(e.g., allow "cidfi.example.net" if a user's ISP is configured with
"example.net").  Similarly, if none of the CNEs are recognized by the client, the client
might silently avoid using CIDFI on that network.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">After authorizing that subset of CNEs, the
client makes a new HTTPS connection to each of those CNEs
and performs PKIX validation of their certificates.
The client <span class="bcp14">MAY</span> have to authenticate itself to the CNE.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">The client then obtains the CIDFI nonce and CIDFI HMAC
secret from each CNE used later in <a href="#ownership" class="auto internal xref">Section 7.2</a> to prove
the client owns its UDP 4-tuple.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span id="name-example-of-cidfi-hmac-and-n"></span><div id="hmac-ex">
<figure id="figure-5">
          <div class="alignCenter art-text artwork" id="section-6.2-5.1">
<pre>
{
   "cidfi-path-authentication":[
      {
         "nonce":"ddqwohxGZysgy0BySNh7sNHV5IH9RbE7rqXmg9wb9Npo",
         "hmac-secret":"jLNsCvuU59mt3F4/ePD9jbZ932TfsLSOP2Nx3XnUqc8v"
      }
   ]
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-cidfi-hmac-and-n" class="selfRef">Example of CIDFI HMAC and Nonce</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="client-operation-on-each-connection-to-a-server">
<section id="section-7">
      <h2 id="name-client-operation-on-each-co">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-client-operation-on-each-co" class="section-name selfRef">Client Operation on Each Connection to a Server</a>
      </h2>
<p id="section-7-1">When a QUIC client connects to a QUIC server, the client:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-2">
<li id="section-7-2.1">
          <p id="section-7-2.1.1">learns if the server supports CIDFI
and obtains its mapping of transmitted Destination CIDs to metadata, described
in <a href="#server-supports-cidfi" class="auto internal xref">Section 7.1</a>.<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.2">
          <p id="section-7-2.2.1">proves ownership of its UDP 4-tuple to
the on-path CNEs, described in <a href="#ownership" class="auto internal xref">Section 7.2</a>.<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.3">
          <p id="section-7-2.3.1">performs initial metadata exchange
with the CIDFI network element and server, and server and network element,
described in <a href="#initial-metadata-exchange" class="auto internal xref">Section 7.3</a>.<a href="#section-7-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.4">
          <p id="section-7-2.4.1">for the duration of the connection, receives network-to-host and performs
host-to-network updates as network conditions or network requirements change,
described in <a href="#ongoing" class="auto internal xref">Section 8</a>. Some policies are provided to CNEs to control which network changes can trigger updating clients.<a href="#section-7-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7-3.1">
          <p id="section-7-3.1.1">Note: the client is also a sender, and can also perform all these
functions in its direction.  This functionality will be expanded in
later versions of this document.  For example, a mobile device
connected to Wi-Fi with 5G backhaul might be running an interactive
audio/video application and want to indicate to its internal Wi-Fi
driver and to the 5G modem its mapping from its transmitted QUIC
Destination CID to per-packet metadata and the application can benefit
from receiving network performance metrics.<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="server-supports-cidfi">
<section id="section-7.1">
        <h3 id="name-client-learns-server-suppor">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-client-learns-server-suppor" class="section-name selfRef">Client Learns Server Supports CIDFI</a>
        </h3>
<p id="section-7.1-1">On initial connection to a QUIC server, the client includes a new QUIC
transport parameter CIDFI (<a href="#iana-tp" class="auto internal xref">Section 17.1</a>) which is remembered for 0-RTT.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">If the server does not indicate CIDFI support, the client can still
perform CIDFI -- but does not expect different CIDs to indicate
differentiated behavior.  The client can still signal its CNE(s) about
the flow, because the client knows some characteristics of the flow it
is receiving.  For example, if the client requested streaming video of
a certain bandwidth from the server or participated in a WebRTC
offer/answer exchange, the client knows some connectivity expectation about the
incoming flow without the server supporting CIDFI.  Processing
continues with the next step.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">If the server indicates CIDFI support, then the server creates a
new Server-Initiated, Bidirectional QUIC stream which is dedicated to
CIDFI communication.  This stream number is communicated in the
CIDFI transport response during the QUIC handshake.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-4.1">
            <p id="section-7.1-4.1.1">TODO: Specify how CIDFI stream number is communicated to client.<a href="#section-7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-5">The QUIC client and server exchange CIDFI information over
this CIDFI-dedicated stream as described in <a href="#initial-metadata-exchange" class="auto internal xref">Section 7.3</a>.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Processing continues with the next step.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ownership">
<section id="section-7.2">
        <h3 id="name-client-proves-ownership-of-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-client-proves-ownership-of-" class="section-name selfRef">Client Proves Ownership of its UDP 4-Tuple</a>
        </h3>
<p id="section-7.2-1">To ensure that the client messages to a CNE
pertain only to the client's own UDP 4-tuple, the client sends the
CIDFI nonce protected by the HMAC secret it obtained from
<a href="#client-authorizes" class="auto internal xref">Section 6.2</a> over the QUIC UDP 4-tuple it is using with the
QUIC server over the path that involves that CNE. The ability to transmit that packet on the same UDP
4-tuple as the QUIC connection indicates ownership of that IP address
and UDP port number.  The nonce and HMAC are sent in a <span>[<a href="#STUN" class="cite xref">STUN</a>]</span> indication (STUN
class of 0b01) containing one or more CIDFI-NONCE attributes
(<a href="#iana-stun" class="auto internal xref">Section 17.5</a>).  If there are multiple CNEs
the single STUN indication contains a CIDFI-NONCE attribute from each of
them.  This message is discarded, if received, by the QUIC server.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">In order to avoid overloading servers, the client may set the TTL/Hop Limit
to a value that allows to cross the CNE, but then dicarded before reaching the server.
For example, the host sets the TTL to "min-ttl" that is returned during CNE discovery.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3"><a href="#flow-diag-attach" class="auto internal xref">Figure 6</a> shows a summarized message flow obtaining
the nonce and HMAC secret from the CNE (steps 1-2) which is performed
on network attach.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<span id="name-example-of-flow-exhange"></span><div id="flow-diag-attach">
<figure id="figure-6">
          <div id="section-7.2-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.2-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="496" viewBox="0 0 496 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,64 L 24,144" fill="none" stroke="black"></path>
                <path d="M 320,96 L 320,144" fill="none" stroke="black"></path>
                <path d="M 472,64 L 472,144" fill="none" stroke="black"></path>
                <path d="M 24,96 L 312,96" fill="none" stroke="black"></path>
                <path d="M 32,128 L 320,128" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="320,96 308,90.4 308,101.6" fill="black" transform="rotate(0,312,96)"></polygon>
                <polygon class="arrowhead" points="40,128 28,122.4 28,133.6" fill="black" transform="rotate(180,32,128)"></polygon>
                <g class="text">
                  <text x="28" y="36">QUIC</text>
                  <text x="312" y="36">CIDFI-aware</text>
                  <text x="468" y="36">QUIC</text>
                  <text x="28" y="52">client</text>
                  <text x="284" y="52">edge</text>
                  <text x="332" y="52">router</text>
                  <text x="468" y="52">server</text>
                  <text x="320" y="68">|</text>
                  <text x="52" y="84">1.</text>
                  <text x="92" y="84">HTTPS:</text>
                  <text x="148" y="84">Enroll</text>
                  <text x="200" y="84">CIDFI</text>
                  <text x="252" y="84">router</text>
                  <text x="292" y="84">to</text>
                  <text x="352" y="84">participate</text>
                  <text x="52" y="116">2.</text>
                  <text x="92" y="116">HTTPS:</text>
                  <text x="136" y="116">Ok.</text>
                  <text x="208" y="116">nonce=12345</text>
                </g>
              </svg><a href="#section-7.2-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-flow-exhange" class="selfRef">Example of Flow Exhange</a>
          </figcaption></figure>
</div>
<p id="section-7.2-5">Later, when connecting to a new QUIC server, the client
determines if there are on-path CIDFI Network Elements by sending the
nonce and HMAC in the same UDP 4-tuple as the QUIC connect
(step 2).  If a CIDFI Network Element is present it processes the STUN
Indication and sends a response to the client over HTTP using the
HTTP channel established above.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<span id="name-example-of-flow-to-new-serv"></span><div id="flow-diag-connect">
<figure id="figure-7">
          <div id="section-7.2-6.1">
            <div class="alignCenter art-svg artwork" id="section-7.2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="512" viewBox="0 0 512 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,64 L 24,352" fill="none" stroke="black"></path>
                <path d="M 320,136 L 320,176" fill="none" stroke="black"></path>
                <path d="M 320,208 L 320,256" fill="none" stroke="black"></path>
                <path d="M 320,328 L 320,352" fill="none" stroke="black"></path>
                <path d="M 472,64 L 472,144" fill="none" stroke="black"></path>
                <path d="M 472,176 L 472,352" fill="none" stroke="black"></path>
                <path d="M 24,96 L 464,96" fill="none" stroke="black"></path>
                <path d="M 24,128 L 464,128" fill="none" stroke="black"></path>
                <path d="M 32,240 L 320,240" fill="none" stroke="black"></path>
                <path d="M 24,288 L 312,288" fill="none" stroke="black"></path>
                <path d="M 32,320 L 472,320" fill="none" stroke="black"></path>
                <path d="M 32,352 L 320,352" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="472,128 460,122.4 460,133.6" fill="black" transform="rotate(0,464,128)"></polygon>
                <polygon class="arrowhead" points="472,96 460,90.4 460,101.6" fill="black" transform="rotate(0,464,96)"></polygon>
                <polygon class="arrowhead" points="320,288 308,282.4 308,293.6" fill="black" transform="rotate(0,312,288)"></polygon>
                <polygon class="arrowhead" points="40,352 28,346.4 28,357.6" fill="black" transform="rotate(180,32,352)"></polygon>
                <polygon class="arrowhead" points="40,320 28,314.4 28,325.6" fill="black" transform="rotate(180,32,320)"></polygon>
                <polygon class="arrowhead" points="40,240 28,234.4 28,245.6" fill="black" transform="rotate(180,32,240)"></polygon>
                <g class="text">
                  <text x="28" y="36">QUIC</text>
                  <text x="312" y="36">CIDFI-aware</text>
                  <text x="468" y="36">QUIC</text>
                  <text x="28" y="52">client</text>
                  <text x="284" y="52">edge</text>
                  <text x="332" y="52">router</text>
                  <text x="468" y="52">server</text>
                  <text x="320" y="68">|</text>
                  <text x="52" y="84">1.</text>
                  <text x="84" y="84">QUIC</text>
                  <text x="140" y="84">Initial,</text>
                  <text x="216" y="84">transport</text>
                  <text x="320" y="84">parameter=CIDFI</text>
                  <text x="52" y="116">2.</text>
                  <text x="84" y="116">STUN</text>
                  <text x="152" y="116">Indication,</text>
                  <text x="252" y="116">nonce=12345,</text>
                  <text x="348" y="116">hmac=e8FEc</text>
                  <text x="420" y="164">3.</text>
                  <text x="472" y="164">discarded</text>
                  <text x="172" y="196">4.</text>
                  <text x="196" y="196">"I</text>
                  <text x="224" y="196">saw</text>
                  <text x="252" y="196">my</text>
                  <text x="292" y="196">nonce,</text>
                  <text x="340" y="196">HMAC</text>
                  <text x="372" y="196">is</text>
                  <text x="412" y="196">valid"</text>
                  <text x="52" y="228">5.</text>
                  <text x="88" y="228">Valid</text>
                  <text x="132" y="228">STUN</text>
                  <text x="196" y="228">Indication</text>
                  <text x="280" y="228">processed</text>
                  <text x="52" y="276">6.</text>
                  <text x="92" y="276">HTTPS:</text>
                  <text x="140" y="276">"Map</text>
                  <text x="196" y="276">DCID=xyz</text>
                  <text x="244" y="276">as</text>
                  <text x="276" y="276">high</text>
                  <text x="344" y="276">importance"</text>
                  <text x="320" y="292">|</text>
                  <text x="52" y="308">7.</text>
                  <text x="84" y="308">QUIC</text>
                  <text x="140" y="308">Initial,</text>
                  <text x="216" y="308">transport</text>
                  <text x="320" y="308">parameter=CIDFI</text>
                  <text x="52" y="340">8.</text>
                  <text x="92" y="340">HTTPS:</text>
                  <text x="132" y="340">Ok</text>
                </g>
              </svg><a href="#section-7.2-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-flow-to-new-serv" class="selfRef">Example of Flow to New Server</a>
          </figcaption></figure>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.2-7.1">
            <p id="section-7.2-7.1.1">Note the above message
flow shows an initial QUIC handshake for simplicity (steps 1 and 7)
but because of QUIC connection migration (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>) the
QUIC messages might appear later.<a href="#section-7.2-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-8">The short header's Destination Connection ID (DCID) can be 0 bytes or
as short as 8 bits, so multiple QUIC clients are likely to use the
same incoming Destination CID on their own UDP 4-tuple. The STUN
Indication message allows the CIDFI network element to distinguish
each QUIC client's UDP 4-tuple.<a href="#section-7.2-8" class="pilcrow">¶</a></p>
<p id="section-7.2-9">Because multiple QUIC clients may use the same incoming Destination CID on
their own UDP 4-tuple, the STUN Indication message allows a CNE
to distinguish each QUIC client's UDP 4-tuple.<a href="#section-7.2-9" class="pilcrow">¶</a></p>
<p id="section-7.2-10">To reduce CIDFI setup time the client STUN Indication <span class="bcp14">MAY</span> be sent at
the same time as it establishes connection with the QUIC server.<a href="#section-7.2-10" class="pilcrow">¶</a></p>
<p id="section-7.2-11">To prevent replay attacks, the Nonce is usable only for authenticating
one UDP 4-tuple.  When the connection is migrated (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>) the CNE won't apply any CIDFI behavior to
that newly-migrated connection.  The client will have to restart
CIDFI procedures at the beginning (<a href="#attach" class="auto internal xref">Section 6</a>).<a href="#section-7.2-11" class="pilcrow">¶</a></p>
<p id="section-7.2-12">After the CIDFI Network Element receives the STUN Indication it
informs the client by sending an HTTP message to the client.  Details TBD.<a href="#section-7.2-12" class="pilcrow">¶</a></p>
<p id="section-7.2-13">As the proof of ownership of its UDP 4-tuple is only useful to CIDFI
Network Elements near the client, the client <span class="bcp14">MAY</span> reduce traffic to the
server by modulating the IPv4 TTL or IPv6 Hop Limit of its STUN Indication messages. The client <span class="bcp14">SHOULD</span> set TTL/Hop Limit to "min-ttl". The client <span class="bcp14">MAY</span> use other values (e.g., explicit configuration, inferred from probe messages).<a href="#section-7.2-13" class="pilcrow">¶</a></p>
<p id="section-7.2-14">Processing continues with the next step.<a href="#section-7.2-14" class="pilcrow">¶</a></p>
<div id="stun-cidfi-nonce-attribute">
<section id="section-7.2.1">
          <h4 id="name-stun-cidfi-nonce-attribute">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-stun-cidfi-nonce-attribute" class="section-name selfRef">STUN CIDFI-NONCE Attribute</a>
          </h4>
<p id="section-7.2.1-1">The format of the STUN CIDFI-NONCE attribute is shown in <a href="#fig-stun-cidfi-nonce" class="auto internal xref">Figure 8</a>.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<span id="name-format-of-stun-cidfi-nonce-"></span><div id="fig-stun-cidfi-nonce">
<figure id="figure-8">
            <div id="section-7.2.1-2.1">
              <div class="alignCenter art-svg artwork" id="section-7.2.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="304" width="528" viewBox="0 0 528 304" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,288" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,288" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,144 L 520,144" fill="none" stroke="black"></path>
                  <path d="M 8,288 L 520,288" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="216" y="100">Nonce</text>
                    <text x="260" y="100">(128</text>
                    <text x="304" y="100">bits)</text>
                    <text x="224" y="212">HMAC-output</text>
                    <text x="292" y="212">(256</text>
                    <text x="336" y="212">bits)</text>
                  </g>
                </svg><a href="#section-7.2.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-format-of-stun-cidfi-nonce-" class="selfRef">Format of STUN CIDFI-NONCE Attribute</a>
            </figcaption></figure>
</div>
<p id="section-7.2.1-3">The nonce is 128 bits obtained from the CIDFI network element.  The
HMAC-output field is computed per <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span> using the CIDFI network
element-provided HMAC secret, and the CIDFI network element-provided
Nonce concatenated with the fixed string "cidfi" (without quotes),
shown below with "|" denoting concatenation.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2.1-4">
<pre>
  HMAC-output = HMAC-SHA256( hmac-secret, nonce | "cidfi" )
</pre><a href="#section-7.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-7.2.1-5">When there are multiple CIDFI Network Elements on the network,
multiple CIDFI-NONCE attributes are sent in a single STUN Indication
message.<a href="#section-7.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="initial-metadata-exchange">
<section id="section-7.3">
        <h3 id="name-initial-metadata-exchange">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-initial-metadata-exchange" class="section-name selfRef">Initial Metadata Exchange</a>
        </h3>
<p id="section-7.3-1">Using its HTTPS channel with each of the CNEs it
previously authorized for CIDFI participation, the client signals the
mapping of the server's transmitted short Destination Connection ID
and its length to the CNE.  As server support
of the QUIC CIDFI transport parameter is remembered for 0-RTT, the
client can immediately send the nonce.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The primary purpose of a second Connection ID is connection migration
(<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>).  With CIDFI, additional Connection IDs are
necessary to:<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-3.1">
            <p id="section-7.3-3.1.1">maintain CIDFI operation when topology remains the same.<a href="#section-7.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-3.2">
            <p id="section-7.3-3.2.1">use Destination Connection ID to indicate packet importance<a href="#section-7.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-4">To maintain CIDFI operation when topology remains the same, the
CIDFI client signals the CNEs of that 'next'
Destination CID.  When QUIC detects a topology change, however, that
Destination CID <span class="bcp14">MUST NOT</span> be used by the peer, otherwise it links
the communication on the old topology to the new topology (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.5" class="relref">Section 9.5</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>).
Thus, an additional Connection ID is purposefully not communicated
from the CIDFI client to its CNEs, so that
Connection ID can be immediately used by the peer during connection
migration when the topology changes.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">Note that the source IP address and source UDP port number are not signaled
by design.  This is because NATs (<span>[<a href="#NAPT" class="cite xref">NAPT</a>]</span>,
<span>[<a href="#NAT" class="cite xref">NAT</a>]</span>), multiple NATs on the path, IPv6/IPv4 translation,
similar technologies, and QUIC connection migration all complicate
accurate signaling of the source IP address and source UDP port
number.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">If the CNE receives the HTTPS map request but has not
yet seen the STUN nonce message it rejects the mapping request with a
403 and provides a new nonce.  The new nonce avoids the problem of an
attacker seeing the previous nonce and using that nonce on its own UDP
4-tuple.  The client then sends a new STUN message with that new nonce
value and send a new HTTPS mapping request(s).  This interaction is
highlighted in the simplified message flow in <a href="#ex-lost-nonce" class="auto internal xref">Figure 9</a>.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<span id="name-example-of-a-client-re-tran"></span><div id="ex-lost-nonce">
<figure id="figure-9">
          <div id="section-7.3-7.1">
            <div class="alignCenter art-svg artwork" id="section-7.3-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="512" viewBox="0 0 512 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,64 L 24,144" fill="none" stroke="black"></path>
                <path d="M 24,176 L 24,480" fill="none" stroke="black"></path>
                <path d="M 320,96 L 320,144" fill="none" stroke="black"></path>
                <path d="M 320,240 L 320,256" fill="none" stroke="black"></path>
                <path d="M 320,288 L 320,320" fill="none" stroke="black"></path>
                <path d="M 320,360 L 320,384" fill="none" stroke="black"></path>
                <path d="M 320,448 L 320,480" fill="none" stroke="black"></path>
                <path d="M 472,64 L 472,144" fill="none" stroke="black"></path>
                <path d="M 472,176 L 472,352" fill="none" stroke="black"></path>
                <path d="M 472,384 L 472,480" fill="none" stroke="black"></path>
                <path d="M 24,96 L 312,96" fill="none" stroke="black"></path>
                <path d="M 32,128 L 320,128" fill="none" stroke="black"></path>
                <path d="M 24,208 L 464,208" fill="none" stroke="black"></path>
                <path d="M 24,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 24,288 L 312,288" fill="none" stroke="black"></path>
                <path d="M 32,320 L 312,320" fill="none" stroke="black"></path>
                <path d="M 24,352 L 464,352" fill="none" stroke="black"></path>
                <path d="M 24,448 L 312,448" fill="none" stroke="black"></path>
                <path d="M 32,480 L 320,480" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="472,352 460,346.4 460,357.6" fill="black" transform="rotate(0,464,352)"></polygon>
                <polygon class="arrowhead" points="472,208 460,202.4 460,213.6" fill="black" transform="rotate(0,464,208)"></polygon>
                <polygon class="arrowhead" points="320,448 308,442.4 308,453.6" fill="black" transform="rotate(0,312,448)"></polygon>
                <polygon class="arrowhead" points="320,288 308,282.4 308,293.6" fill="black" transform="rotate(0,312,288)"></polygon>
                <polygon class="arrowhead" points="320,96 308,90.4 308,101.6" fill="black" transform="rotate(0,312,96)"></polygon>
                <polygon class="arrowhead" points="200,240 188,234.4 188,245.6" fill="black" transform="rotate(0,192,240)"></polygon>
                <polygon class="arrowhead" points="40,480 28,474.4 28,485.6" fill="black" transform="rotate(180,32,480)"></polygon>
                <polygon class="arrowhead" points="40,320 28,314.4 28,325.6" fill="black" transform="rotate(180,32,320)"></polygon>
                <polygon class="arrowhead" points="40,128 28,122.4 28,133.6" fill="black" transform="rotate(180,32,128)"></polygon>
                <g class="text">
                  <text x="312" y="36">CIDFI-aware</text>
                  <text x="468" y="36">QUIC</text>
                  <text x="28" y="52">client</text>
                  <text x="284" y="52">edge</text>
                  <text x="332" y="52">router</text>
                  <text x="468" y="52">server</text>
                  <text x="320" y="68">|</text>
                  <text x="68" y="84">HTTPS:</text>
                  <text x="124" y="84">Enroll</text>
                  <text x="176" y="84">CIDFI</text>
                  <text x="228" y="84">router</text>
                  <text x="268" y="84">to</text>
                  <text x="328" y="84">participate</text>
                  <text x="68" y="116">HTTPS:</text>
                  <text x="112" y="116">Ok.</text>
                  <text x="184" y="116">nonce=12345</text>
                  <text x="24" y="164">:</text>
                  <text x="320" y="164">:</text>
                  <text x="472" y="164">:</text>
                  <text x="320" y="180">|</text>
                  <text x="60" y="196">QUIC</text>
                  <text x="116" y="196">Initial,</text>
                  <text x="192" y="196">transport</text>
                  <text x="296" y="196">parameter=CIDFI</text>
                  <text x="60" y="228">STUN</text>
                  <text x="128" y="228">Indication,</text>
                  <text x="228" y="228">nonce=12345,</text>
                  <text x="324" y="228">HMAC=8f93e</text>
                  <text x="208" y="244">X</text>
                  <text x="244" y="244">(lost)</text>
                  <text x="68" y="276">HTTPS:</text>
                  <text x="116" y="276">"Map</text>
                  <text x="172" y="276">DCID=xyz</text>
                  <text x="220" y="276">as</text>
                  <text x="252" y="276">high</text>
                  <text x="320" y="276">importance"</text>
                  <text x="68" y="308">HTTPS:</text>
                  <text x="116" y="308">403,</text>
                  <text x="152" y="308">new</text>
                  <text x="212" y="308">Nonce=5678</text>
                  <text x="60" y="340">STUN</text>
                  <text x="120" y="340">Indicate,</text>
                  <text x="208" y="340">nonce=5678,</text>
                  <text x="300" y="340">HMAC=aaf3c</text>
                  <text x="472" y="372">discarded</text>
                  <text x="196" y="404">"I</text>
                  <text x="224" y="404">saw</text>
                  <text x="252" y="404">my</text>
                  <text x="292" y="404">nonce,</text>
                  <text x="340" y="404">HMAC</text>
                  <text x="372" y="404">is</text>
                  <text x="412" y="404">valid"</text>
                  <text x="320" y="420">|</text>
                  <text x="68" y="436">HTTPS:</text>
                  <text x="116" y="436">"Map</text>
                  <text x="172" y="436">DCID=xyz</text>
                  <text x="220" y="436">as</text>
                  <text x="252" y="436">high</text>
                  <text x="320" y="436">importance"</text>
                  <text x="52" y="468">Ok</text>
                </g>
              </svg><a href="#section-7.3-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-of-a-client-re-tran" class="selfRef">Example of a Client Re-transmitting Lost Nonce</a>
          </figcaption></figure>
</div>
<p id="section-7.3-8">After the initial metadata is exchanged, processing continues with
ongoing host-to-network and network-to-host updates as described in
<a href="#ongoing" class="auto internal xref">Section 8</a>.<a href="#section-7.3-8" class="pilcrow">¶</a></p>
<p id="section-7.3-9">There are two types of metadata exchanged, described in the following sub-sections.<a href="#section-7.3-9" class="pilcrow">¶</a></p>
<div id="host-to-network">
<section id="section-7.3.1">
          <h4 id="name-host-to-network-signaling">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-host-to-network-signaling" class="section-name selfRef">Host to Network Signaling</a>
          </h4>
<p id="section-7.3.1-1">The server communicates to CNEs via the client which then
communicates with the CNE(s).  While this adds
communication delay, it allows the user at the client to authorize
the metadata communication about its own incoming (and outgoing) traffic.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">The communication from the client to the server are using a CIDFI-dedicated
QUIC stream over the same QUIC connection as their primary communication (<a href="#ex-comm" class="auto internal xref">Figure 10</a>).<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<span id="name-example-of-cidfi-communicat"></span><div id="ex-comm">
<figure id="figure-10">
            <div id="section-7.3.1-3.1">
              <div class="alignCenter art-svg artwork" id="section-7.3.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="496" viewBox="0 0 496 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,64 L 24,272" fill="none" stroke="black"></path>
                  <path d="M 176,128 L 176,144" fill="none" stroke="black"></path>
                  <path d="M 176,184 L 176,232" fill="none" stroke="black"></path>
                  <path d="M 320,104 L 320,264" fill="none" stroke="black"></path>
                  <path d="M 472,64 L 472,272" fill="none" stroke="black"></path>
                  <path d="M 32,96 L 472,96" fill="none" stroke="black"></path>
                  <path d="M 24,144 L 168,144" fill="none" stroke="black"></path>
                  <path d="M 24,176 L 312,176" fill="none" stroke="black"></path>
                  <path d="M 32,208 L 176,208" fill="none" stroke="black"></path>
                  <path d="M 32,240 L 320,240" fill="none" stroke="black"></path>
                  <path d="M 24,272 L 464,272" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="472,272 460,266.4 460,277.6" fill="black" transform="rotate(0,464,272)"></polygon>
                  <polygon class="arrowhead" points="320,176 308,170.4 308,181.6" fill="black" transform="rotate(0,312,176)"></polygon>
                  <polygon class="arrowhead" points="176,144 164,138.4 164,149.6" fill="black" transform="rotate(0,168,144)"></polygon>
                  <polygon class="arrowhead" points="40,240 28,234.4 28,245.6" fill="black" transform="rotate(180,32,240)"></polygon>
                  <polygon class="arrowhead" points="40,208 28,202.4 28,213.6" fill="black" transform="rotate(180,32,208)"></polygon>
                  <polygon class="arrowhead" points="40,96 28,90.4 28,101.6" fill="black" transform="rotate(180,32,96)"></polygon>
                  <g class="text">
                    <text x="168" y="36">CIDFI-aware</text>
                    <text x="312" y="36">CIDFI-aware</text>
                    <text x="28" y="52">client</text>
                    <text x="112" y="52">Wi-Fi</text>
                    <text x="164" y="52">Access</text>
                    <text x="216" y="52">Point</text>
                    <text x="284" y="52">edge</text>
                    <text x="332" y="52">router</text>
                    <text x="468" y="52">server</text>
                    <text x="176" y="68">|</text>
                    <text x="320" y="68">|</text>
                    <text x="60" y="84">QUIC</text>
                    <text x="104" y="84">CIDFI</text>
                    <text x="160" y="84">stream:</text>
                    <text x="212" y="84">"Map</text>
                    <text x="268" y="84">DCID=xyz</text>
                    <text x="316" y="84">as</text>
                    <text x="348" y="84">high</text>
                    <text x="416" y="84">importance"</text>
                    <text x="60" y="116">"Map</text>
                    <text x="116" y="116">DCID=xyz</text>
                    <text x="164" y="116">as</text>
                    <text x="60" y="132">high</text>
                    <text x="128" y="132">importance"</text>
                    <text x="60" y="164">"Map</text>
                    <text x="116" y="164">DCID=xyz</text>
                    <text x="164" y="164">as</text>
                    <text x="196" y="164">high</text>
                    <text x="264" y="164">importance"</text>
                    <text x="52" y="196">Ok</text>
                    <text x="52" y="228">Ok</text>
                    <text x="60" y="260">QUIC</text>
                    <text x="104" y="260">CIDFI</text>
                    <text x="160" y="260">stream:</text>
                    <text x="204" y="260">Ok</text>
                  </g>
                </svg><a href="#section-7.3.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-cidfi-communicat" class="selfRef">Example of CIDFI Communication</a>
            </figcaption></figure>
</div>
<p id="section-7.3.1-4">To each of the network elements authorized by the client, the client
sends the mappings of the server's transmitted Destination CIDs to
packet metadata (see <a href="#metadata-exchanged" class="auto internal xref">Section 11</a>).<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-to-host">
<section id="section-7.3.2">
          <h4 id="name-network-to-host-signaling">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-network-to-host-signaling" class="section-name selfRef">Network to Host Signaling</a>
          </h4>
<p id="section-7.3.2-1">The CNE sends network performance information to the server
which is intended to influence the sender's traffic rate (such as
improving or reducing fidelity of the audio or video).  In <a href="#ex-comm-metadata" class="auto internal xref">Figure 11</a>,
the CNE informs the client of reduced bandwidth and the
client informs the server using CIDFI.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<span id="name-example-of-cidfi-communicati"></span><div id="ex-comm-metadata">
<figure id="figure-11">
            <div id="section-7.3.2-2.1">
              <div class="alignCenter art-svg artwork" id="section-7.3.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="448" viewBox="0 0 448 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,64 L 24,192" fill="none" stroke="black"></path>
                  <path d="M 320,64 L 320,96" fill="none" stroke="black"></path>
                  <path d="M 320,168 L 320,192" fill="none" stroke="black"></path>
                  <path d="M 424,64 L 424,192" fill="none" stroke="black"></path>
                  <path d="M 32,96 L 320,96" fill="none" stroke="black"></path>
                  <path d="M 24,128 L 416,128" fill="none" stroke="black"></path>
                  <path d="M 32,160 L 424,160" fill="none" stroke="black"></path>
                  <path d="M 24,192 L 312,192" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="424,128 412,122.4 412,133.6" fill="black" transform="rotate(0,416,128)"></polygon>
                  <polygon class="arrowhead" points="320,192 308,186.4 308,197.6" fill="black" transform="rotate(0,312,192)"></polygon>
                  <polygon class="arrowhead" points="40,160 28,154.4 28,165.6" fill="black" transform="rotate(180,32,160)"></polygon>
                  <polygon class="arrowhead" points="40,96 28,90.4 28,101.6" fill="black" transform="rotate(180,32,96)"></polygon>
                  <g class="text">
                    <text x="168" y="36">CIDFI-aware</text>
                    <text x="312" y="36">CIDFI-aware</text>
                    <text x="28" y="52">client</text>
                    <text x="112" y="52">Wi-Fi</text>
                    <text x="164" y="52">Access</text>
                    <text x="216" y="52">Point</text>
                    <text x="284" y="52">edge</text>
                    <text x="332" y="52">router</text>
                    <text x="420" y="52">server</text>
                    <text x="176" y="68">|</text>
                    <text x="84" y="84">"bandwidth</text>
                    <text x="144" y="84">now</text>
                    <text x="188" y="84">1Mbps"</text>
                    <text x="60" y="116">QUIC</text>
                    <text x="104" y="116">CIDFI</text>
                    <text x="160" y="116">stream:</text>
                    <text x="236" y="116">"bandwidth</text>
                    <text x="296" y="116">now</text>
                    <text x="340" y="116">1Mbps"</text>
                    <text x="60" y="148">QUIC</text>
                    <text x="104" y="148">CIDFI</text>
                    <text x="160" y="148">stream:</text>
                    <text x="204" y="148">Ok</text>
                    <text x="320" y="148">|</text>
                    <text x="52" y="180">Ok</text>
                    <text x="176" y="180">|</text>
                  </g>
                </svg><a href="#section-7.3.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-of-cidfi-communicati" class="selfRef">Example of CIDFI Communication with Metadata Sharing</a>
            </figcaption></figure>
</div>
<p id="section-7.3.2-3">The communication from the client to the server is using a CIDFI-dedicated
QUIC stream over the same QUIC connection as their primary communication.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.3.2-4">The CNE can update the client with whenever
the metadata about the connection changes significantly, but <span class="bcp14">MUST NOT</span>
update more frequently than once every second.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.2-5">The metadata exchanged over this channel is described in <a href="#metadata-exchanged" class="auto internal xref">Section 11</a>.<a href="#section-7.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ongoing">
<section id="section-8">
      <h2 id="name-ongoing-signaling">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ongoing-signaling" class="section-name selfRef">Ongoing Signaling</a>
      </h2>
<p id="section-8-1">Throughout the life of the connection host-to-network and network-to-host
signaling is updated whenever characteristics change. Still, some policies are provided to control when these updates are triggers. Such policies are meant to preserve the connection stability.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Typically, due to environmental changes on wireless networks or other user's
traffic patterns, a particular flow may be able to operate faster or
might need to operate slower.  The relevant CNE <span class="bcp14">SHOULD</span> signal
such conditions to the client (<a href="#network-to-host" class="auto internal xref">Section 7.3.2</a>), which can then
relay that information to the server using either CIDFI or via its
application.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">For example, a  streaming video client might be retrieving low quality
video because one of their invoked CNEs indicated constrained
bandwidth.  Later, after moving closer to an antenna, more bandwidth is
available which is signaled by the CNE to the client.
The client uses that signal to now request higher-quality video from
the server.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Similarly, the CIDFI client may begin receiving traffic
with different characteristics which might be be signaled to the CNEs.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">For example, a client might be participating in an audio-only call
which is modified to audio and video, requiring additional bandwidth
and likely new CIDs to differentiate the video packets from the audio
packets.<a href="#section-8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="load-balancers">
<section id="section-9">
      <h2 id="name-interaction-with-load-balan">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-interaction-with-load-balan" class="section-name selfRef">Interaction with Load Balancers</a>
      </h2>
<p id="section-9-1">QUIC servers are likely to be behind CID-aware load balancers <span>[<a href="#I-D.ietf-quic-load-balancers" class="cite xref">I-D.ietf-quic-load-balancers</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">With CIDFI, all the communications to the load-balanced QUIC server are over the same UDP 4-tuple
as the primary QUIC connection but in a different QUIC stream.  This means
no changes are required to ECMP load balancers or to CID-aware load balancers
when using a CIDFI-aware back-end QUIC server.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Load balancers providing QUIC-to-TCP interworking are incompatible with
CIDFI because TCP lacks QUIC's stream identification.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="topology">
<section id="section-10">
      <h2 id="name-topology-change">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-topology-change" class="section-name selfRef">Topology Change</a>
      </h2>
<p id="section-10-1">When the topology changes the client will transmit from a new IP
address -- such as switching to a backup WAN connection, or such as
switching from Wi-Fi to 5G.  If using QUIC, the server will consider
this as a connection migration (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>) and will issue a
PATH_CHALLENGE.  If the client is aware of the topology change (such
as attaching to a different network), the client would also change its
QUIC Destination CID (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>).<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">When the CIDFI-aware client determines that it is connected to a new
network or has received a QUIC PATH_CHALLENGE, the CIDFI-aware client
<span class="bcp14">MUST</span> re-discover its CNEs (<a href="#discovery" class="auto internal xref">Section 6.1</a>) and continue with normal CIDFI
processing with any discovered CNEs.<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-exchanged">
<section id="section-11">
      <h2 id="name-details-of-metadata-exchang">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-details-of-metadata-exchang" class="section-name selfRef">Details of Metadata Exchanged</a>
      </h2>
<p id="section-11-1">This section describes the metadata that can be exchanged from a
CNE to a server (generally network
performance information) and from the server to a CNE.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="server-to-cidfi-aware-network-element">
<section id="section-11.1">
        <h3 id="name-server-to-cidfi-aware-netwo">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-server-to-cidfi-aware-netwo" class="section-name selfRef">Server to CIDFI-aware Network Element</a>
        </h3>
<p id="section-11.1-1">Because there is no direct communication from the server to
a CNE, the communication is relayed through the client.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">The communications from servers to CNEs do not occur directly,
but rather through the client.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">Two types of mapping metadata are described in the following sub-sections: metadata parameters
and DSCP values.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<div id="mapping-parameters">
<section id="section-11.1.1">
          <h4 id="name-mapping-metadata-parameters">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-mapping-metadata-parameters" class="section-name selfRef">Mapping Metadata Parameters to DCIDs</a>
          </h4>
<p id="section-11.1.1-1">Several of metadata parameters can be mapped to Destination CIDs:<a href="#section-11.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.1.1-2">
            <dt id="section-11.1.1-2.1">Importance:</dt>
            <dd style="margin-left: 1.5em" id="section-11.1.1-2.2">
              <p id="section-11.1.1-2.2.1">Low/Medium/High importance, relative to other CIDs within this
same UDP 4-tuple.<a href="#section-11.1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.1-2.3">Delay budget:</dt>
            <dd style="margin-left: 1.5em" id="section-11.1.1-2.4">
              <p id="section-11.1.1-2.4.1">Time in milliseconds until this packet is worthless to the receiver.
This is counted from when the packet arrives at the CNE
to when it is transmitted; other delays may occur
before or after that event occurs.  The receiver knows its own jitter
(playout) buffer length and the client and server can calculate the
one-way delay using timestamps.  With that information, the client can
adjust the server's signaled delay budget with the client's own
knowledge.<a href="#section-11.1.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1.1-3.1">
              <p id="section-11.1.1-3.1.1">TODO: provide enough details to create interoperable
implementations.<a href="#section-11.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-11.1.1-4">Over the CIDFI-dedicated QUIC stream, the server sends mapping
information to the client when then propagates that information
to each of the CNEs. An example is shown in <a href="#fig-import" class="auto internal xref">Figure 12</a>.<a href="#section-11.1.1-4" class="pilcrow">¶</a></p>
<span id="name-example-json-for-flow-impor"></span><div id="fig-import">
<figure id="figure-12">
            <div class="alignLeft art-json art-text artwork" id="section-11.1.1-5.1">
<pre>
{
   "metadata-parameters":[
      {
         "quicversion":1,
         "dcidlength":3,
         "map":[
            {
               "import":17,
               "burst":83,
               "delaybudget":71,
               "dcids":[
                  551,
                  381
               ]
            },
            {
               "import":3,
               "burst":888,
               "delaybudget":180,
               "dcids":[
                  89,
                  983
               ]
            },
            {
               "import":7,
               "burst":37,
               "delaybudget":55,
               "dcids":[
                  33
               ]
            }
         ]
      }
   ]
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-json-for-flow-impor" class="selfRef">Example JSON for Flow Importance</a>
            </figcaption></figure>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1.1-6.1">
              <p id="section-11.1.1-6.1.1">Note: <a href="#fig-import" class="auto internal xref">Figure 12</a> lists sample attributes and they will be discussed in detail in a separate document.<a href="#section-11.1.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="mapping-dscp">
<section id="section-11.1.2">
          <h4 id="name-mapping-diffserv-code-point">
<a href="#section-11.1.2" class="section-number selfRef">11.1.2. </a><a href="#name-mapping-diffserv-code-point" class="section-name selfRef">Mapping DiffServ Code Point (DSCP) to DCIDs</a>
          </h4>
<p id="section-11.1.2-1">A mapping from Destination CID to DiffServ code point
<span>[<a href="#RFC2474" class="cite xref">RFC2474</a>]</span> leverages existing DiffServ handling that may already
exist in the CIDFI network element.  If there are downstream network
elements configured with the same DSCP the CIDFI
network element could mark the packet with that code point as well.<a href="#section-11.1.2-1" class="pilcrow">¶</a></p>
<p id="section-11.1.2-2">Signaling the DSCP values for different QUIC Destination CIDs
increases the edge network's confidence that the sender's DiffServ intent
is preserved into the edge network, even if the DSCP bits were
modified en route to the edge network (e.g., <span>[<a href="#pathologies" class="cite xref">pathologies</a>]</span>).<a href="#section-11.1.2-2" class="pilcrow">¶</a></p>
<p id="section-11.1.2-3">Over the CIDFI-dedicated QUIC stream, the server sends the mapping
information to the client when then propagates that information
to each of the CNEs.<a href="#section-11.1.2-3" class="pilcrow">¶</a></p>
<p id="section-11.1.2-4">An example is shown in <a href="#fig-dscp-json" class="auto internal xref">Figure 13</a>.<a href="#section-11.1.2-4" class="pilcrow">¶</a></p>
<span id="name-example-json-for-dscp-mappi"></span><div id="fig-dscp-json">
<figure id="figure-13">
            <div class="alignLeft art-json art-text artwork" id="section-11.1.2-5.1">
<pre>
{
   "dscp":[
      {
         "quicversion":1,
         "dcidlength":3,
         "map":[
            {
               "dscp":10,
               "dcids":[
                  123,
                  456
               ]
            },
            {
               "dscp":46,
               "dcids":[
                  998,
                  183
               ]
            }
         ]
      }
   ]
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-json-for-dscp-mappi" class="selfRef">Example JSON for DSCP Mapping</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="cidfi-aware-network-element-to-server">
<section id="section-11.2">
        <h3 id="name-cidfi-aware-network-element">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-cidfi-aware-network-element" class="section-name selfRef">CIDFI-aware Network Element to Server</a>
        </h3>
<p id="section-11.2-1">The CIDFI-aware client informs the CNE of the client's
received Destination CIDs.  As bandwidth availability to that client
changes, the CNE updates the client with new
metadata.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-2">
<pre>
{
   "dcid":123,
   "bandwidth":"1Mbps"
}
</pre><a href="#section-11.2-2" class="pilcrow">¶</a>
</div>
<p id="section-11.2-3">The client then sends that information to the server in the CIDFI-dedicated
QUIC stream associated with that same Connection ID.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-12">
      <h2 id="name-privacy-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="privacy-aware-metadata-sharing-in-network-relationships">
<section id="section-12.1">
        <h3 id="name-privacy-aware-metadata-shar">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-privacy-aware-metadata-shar" class="section-name selfRef">Privacy-Aware Metadata Sharing in Network Relationships</a>
        </h3>
<p id="section-12.1-1">If the network operator and the server have a business relationship,
the server can sign or attest the metadata using, e.g., JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> or CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>. The
attested metadata will be sent from the server to the client. The client
will decide whether to convey the attested metadata to the CNE, considering
privacy reasons, as it may reveal the identity of the server to the network.
The client may use any local policy or involve the end-user in the decision-making process regarding
whether to reveal the identity of the server to the network or not.
If the attested metadata is sent to the CNE from the client, the attestation
will be utilized by the CNE, acting as a Relying Party (e.g., <span><a href="https://rfc-editor.org/rfc/rfc9334#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>), to determine the
level of trust it wishes to place in the attested metadata. The relying party
may choose to trust or not trust the attestation.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discussion-points">
<section id="section-13">
      <h2 id="name-discussion-points">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-discussion-points" class="section-name selfRef">Discussion Points</a>
      </h2>
<p id="section-13-1">This section discusses known issues that would benefit from wider discussion.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="client-versus-server-signaling-cid-to-importance-mapping">
<section id="section-13.1">
        <h3 id="name-client-versus-server-signal">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-client-versus-server-signal" class="section-name selfRef">Client versus Server Signaling CID-to-importance Mapping</a>
        </h3>
<p id="section-13.1-1">Need to evaluate number of round trips (and other overhead) of client
signaling CID-to-importance mapping or server signaling CID-to-importance
mapping.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overhead-of-quic-dcid-packet-examination">
<section id="section-13.2">
        <h3 id="name-overhead-of-quic-dcid-packe">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-overhead-of-quic-dcid-packe" class="section-name selfRef">Overhead of QUIC DCID Packet Examination</a>
        </h3>
<p id="section-13.2-1">If CID-to-importance metadata was signaled by the server as described
in <a href="#host-to-network" class="auto internal xref">Section 7.3.1</a>, the CNE have to
examine the UDP payload of each packet for a matching Destination CID
for the lifetime of the connection.  This is somewhat assuaged by
the STUN nonce transmitted which may well be an easier signal to
identify.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interaction-with-wi-fi-packet-aggregation">
<section id="section-13.3">
        <h3 id="name-interaction-with-wi-fi-pack">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-interaction-with-wi-fi-pack" class="section-name selfRef">Interaction with Wi-Fi Packet Aggregation</a>
        </h3>
<p id="section-13.3-1">Per-packet metadata influences transmission of that packet but may
well conflict with some Wi-Fi optimizations (e.g., <span>[<a href="#wifi-aggregation" class="cite xref">wifi-aggregation</a>]</span>)
and similar 5G optimizations.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2">This impact needs further study.<a href="#section-13.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overhead-of-mapping-cids-to-packet-metadata">
<section id="section-13.4">
        <h3 id="name-overhead-of-mapping-cids-to">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-overhead-of-mapping-cids-to" class="section-name selfRef">Overhead of Mapping CIDs to Packet Metadata</a>
        </h3>
<p id="section-13.4-1">Network Elements have to maintain a mapping between each UDP 4-tuple
and QUIC CID and its DSCP code point.  This also needs updating
whenever sender changes its CID.  This is awkward.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<p id="section-13.4-2">An alternative is a fixed mapping of QUIC CIDs to their meanings,
as proposed in <span>[<a href="#I-D.zmlk-quic-te" class="cite xref">I-D.zmlk-quic-te</a>]</span>.  However, this will ossify
the meaning of those QUIC CIDs.  It also requires all networks to
agree on the meaning of those QUIC CIDs.<a href="#section-13.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="improve-cidfi-initialization-time">
<section id="section-13.5">
        <h3 id="name-improve-cidfi-initializatio">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-improve-cidfi-initializatio" class="section-name selfRef">Improve CIDFI Initialization Time</a>
        </h3>
<p id="section-13.5-1">Find approaches to further reduce network communications to start CIDFI.<a href="#section-13.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="primary-cid-change">
<section id="section-13.6">
        <h3 id="name-primary-quic-channel-cid-ch">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-primary-quic-channel-cid-ch" class="section-name selfRef">Primary QUIC Channel CID Change</a>
        </h3>
<p id="section-13.6-1">Because the CIDFI network element, QUIC server, and QUIC client all
cooperate to share the primary QUIC connection's Destination CID,
when a new CIDFI network element is involved (e.g., due to client
attaching to a different network), a new Destination CID <span class="bcp14">SHOULD</span>
be used for the reasons discussed in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.5" class="relref">Section 9.5</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>).<a href="#section-13.6-1" class="pilcrow">¶</a></p>
<p id="section-13.6-2">We need clear way to signal which DCIDs can be used for 'this'
network attach and which DCIDs are for a migrated connection.  Probably
belongs in the QUIC transport parameter signaling?<a href="#section-13.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="state-maintenance">
<section id="section-14">
      <h2 id="name-state-maintenance">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-state-maintenance" class="section-name selfRef">State Maintenance</a>
      </h2>
<p id="section-14-1">A CNE can safely remove state after UDP inactivity timeout <span><a href="https://rfc-editor.org/rfc/rfc4787#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC4787" class="cite xref">RFC4787</a>]</span>.  The CIDFI client <span class="bcp14">MUST</span> re-signal its CNE(s) when it
receives a QUIC path validation message, as that indicates a NAT
rebinding occurred.  A CNE's state can also be cleared by signaling from
the CIDFI client, such as when closing the application; however, this
signal cannot be relied upon due to network disconnect, battery
depletion, and suchlike.<a href="#section-14-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-14-2.1">
          <p id="section-14-2.1.1">TODO: Probably want keepalives on client-&gt;CNE communication. To be assessed.<a href="#section-14-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="api-integration">
<section id="section-15">
      <h2 id="name-api-integration-for-quic-st">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-api-integration-for-quic-st" class="section-name selfRef">API Integration for QUIC Stream and Packet-Level Prioritization</a>
      </h2>
<p id="section-15-1">For each QUIC stream requiring differentiated service, the QUIC stack can
map that stream to a different Destination CID. The application-level code
would require an API to instruct the QUIC stack that a particular stream
needs differentiated service. Similarly, if the application-level code seeks
differentiated service for packets within a stream (e.g., prioritizing P-frames
over I-Frames in a video stream), it would need an API to inform the QUIC stack
that different packets within the QUIC stream require differentiated services
and to map these packets to different Destination CIDs.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2"><strong>Where packet-level differentiation is not desired, such API enhancements
are not needed</strong>.  In that situation, the CIDFI-aware client and CIDFI-aware
network elements can utilize bandwidth information to optimize their video
streaming usage and their interactive audio/video streams, without the
benefit of packet-level differentiation.<a href="#section-15-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-16">
      <h2 id="name-security-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-16-1">Because the sender's QUIC Destination Connection ID is mapped to
packet importance, and the DCID remains the same for many packets, an
attacker could determine which DCIDs are important by causing
interference on the bandwidth-constrained link (by creating other
legitimate traffic or creating radio interference) and observing which
DCIDs are transmitted versus which DCIDs are dropped.  This is a side-
effect of using fixed identifier (DCIDs) rather than encrypting
the packet importance.  This was a design trade-off to reduce the
CPU effort on the CNEs.  A mitigation is using
several DCIDs for every packet importance.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">Other than what can be inferred from a destination IP address, the server's identity is not disclosed to the CIDFI Network Elements,
thus maintaining the end user's privacy.  Communications are relayed through the client because only the
client knows the identity of the server and can validate
its certificate.<a href="#section-16-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-16-3">
        <dt id="section-16-3.1">Spoofing Attacks:</dt>
        <dd style="margin-left: 1.5em" id="section-16-3.2">
          <p id="section-16-3.2.1">For an attacker to succeed with the nonce challenge against a victim's UDP 4-tuple, an attacker has to send a STUN CIDFI-NONCE packet using the victim's source IP address and a valid HMAC. A valid HMAC can be obtained by the attacker making its own connection to the CIDFI-aware server and spoofing the source IP address and UDP port number of the victim.<a href="#section-16-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-3.3"></dt>
        <dd style="margin-left: 1.5em" id="section-16-3.4">
          <p id="section-16-3.4.1">If the client does not support CIDFI, the attacker can influence the packet treatment of the victim's UDP 4-tuple.<a href="#section-16-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-3.5"></dt>
        <dd style="margin-left: 1.5em" id="section-16-3.6">
          <p id="section-16-3.6.1">If the client implements CIDFI, a CIDFI network element can identify an IP address spoofing attack. Concretely, the CNE will receive two HTTPS connections describing the same DCID; one connection from the attacker and another one from the victim. The CNE will then issue unique Nonces and HMACs to both the attacker and victim, and both the attacker and victim should send the STUN Indication on that same UDP 4-tuple. Such an event should trigger an alarm on the CNE. In this scenario, it is recommended that both the attacker and the victim be denied CIDFI access.<a href="#section-16-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-3.7"></dt>
        <dd style="margin-left: 1.5em" id="section-16-3.8">
          <p id="section-16-3.8.1">The spoofing of a victim's IP address is prevented by the network using network ingress filtering (<span>[<a href="#RFC2827" class="cite xref">RFC2827</a>]</span>, <span>[<a href="#RFC7513" class="cite xref">RFC7513</a>]</span>, <span>[<a href="#RFC6105" class="cite xref">RFC6105</a>]</span>, and/or <span>[<a href="#RFC6620" class="cite xref">RFC6620</a>]</span>).<a href="#section-16-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-3.9">On-Path Attacks:</dt>
        <dd style="margin-left: 1.5em" id="section-16-3.10">
          <p id="section-16-3.10.1">An on-path attacker can observe the victim's Discovery Packet, block it, and then forward the packet within the attacker's 5-tuple. Subsequently, the on-path attacker can 'steal' the victim's CIDFI control from the victim's UDP 4-tuple, causing the victim's CIDFI signaling for that UDP 4-tuple to influence the attacker's UDP 4-tuple.<a href="#section-16-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-3.11"></dt>
        <dd style="margin-left: 1.5em" id="section-16-3.12">
          <p id="section-16-3.12.1">Although the on-path attacker can't directly observe the encrypted CIDFI signaling, this attack effectively disables the victim's CIDFI treatment, making it accessible to the attacker. The attacker can send NEW_CONNECTION_ID frames to the server with the victim's (observed) Destination CID, effectively claiming the victim's CIDFI signaling for themselves. An on-path attacker can do a lot more damage by blocking or rate-limiting the victim's traffic.<a href="#section-16-3.12.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-considerations">
<section id="section-17">
      <h2 id="name-iana-considerations">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="iana-tp">
<section id="section-17.1">
        <h3 id="name-new-quic-transport-paramete">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-new-quic-transport-paramete" class="section-name selfRef">New QUIC Transport Parameter</a>
        </h3>
<p id="section-17.1-1">This document requests IANA to register the following new permanent QUIC transport parameter
in the "QUIC Transport Parameters" registry under the "QUIC" registry group available at <span>[<a href="#IANA-QUIC" class="cite xref">IANA-QUIC</a>]</span>:<a href="#section-17.1-1" class="pilcrow">¶</a></p>
<span id="name-new-quic-transport-parameter"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-new-quic-transport-parameter" class="selfRef">New QUIC Transport Parameter</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Parameter Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">CIDFI</td>
              <td class="text-left" rowspan="1" colspan="1">This-Document</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-uri">
<section id="section-17.2">
        <h3 id="name-new-well-known-uri-cidfi-aw">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-new-well-known-uri-cidfi-aw" class="section-name selfRef">New Well-known URI "cidfi-aware"</a>
        </h3>
<p id="section-17.2-1">This document requests IANA to register the new well-known URI "cidfi" in the
"Well-Known URIs" registry available at <span>[<a href="#IANA-WKU" class="cite xref">IANA-WKU</a>]</span>.<a href="#section-17.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-sudn">
<section id="section-17.3">
        <h3 id="name-new-special-use-domain-name">
<a href="#section-17.3" class="section-number selfRef">17.3. </a><a href="#name-new-special-use-domain-name" class="section-name selfRef">New Special-use Domain Name</a>
        </h3>
<p id="section-17.3-1">Register new special-use domain name cidfi.arpa for DNS SVCB discovery.<a href="#section-17.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-svcb">
<section id="section-17.4">
        <h3 id="name-new-dns-service-binding-svc">
<a href="#section-17.4" class="section-number selfRef">17.4. </a><a href="#name-new-dns-service-binding-svc" class="section-name selfRef">New DNS Service Binding (SVCB)</a>
        </h3>
<p id="section-17.4-1">This document requests IANA to register the new DNS SVCB "_cidfi-aware" in
the "DNS Service Bindings (SVCB)" registry available at <span>[<a href="#IANA-SVCB" class="cite xref">IANA-SVCB</a>]</span>.<a href="#section-17.4-1" class="pilcrow">¶</a></p>
<p id="section-17.4-2">The document also requests IANA to register the following service parameter
in the "Service Parameter Keys (SvcParamKeys)" registry <span>[<a href="#IANA-SVCB" class="cite xref">IANA-SVCB</a>]</span>:<a href="#section-17.4-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-17.4-3">
          <dt id="section-17.4-3.1">Number:</dt>
          <dd style="margin-left: 1.5em" id="section-17.4-3.2">
            <p id="section-17.4-3.2.1">TBD<a href="#section-17.4-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-17.4-3.3">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-17.4-3.4">
            <p id="section-17.4-3.4.1">min-ttl<a href="#section-17.4-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-17.4-4">Meaning:
:The minimum IPv4 TTL or IPv6 Hop Limit to use for a connection.<a href="#section-17.4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-17.4-5">
          <dt id="section-17.4-5.1">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-17.4-5.2">
            <p id="section-17.4-5.2.1">This-Document<a href="#section-17.4-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-stun">
<section id="section-17.5">
        <h3 id="name-new-stun-attribute">
<a href="#section-17.5" class="section-number selfRef">17.5. </a><a href="#name-new-stun-attribute" class="section-name selfRef">New STUN Attribute</a>
        </h3>
<p id="section-17.5-1">This document requests IANA to register the new STUN attribute "CIDFI-NONCE"
in the "STUN Attributes" registry available at <span>[<a href="#IANA-STUN" class="cite xref">IANA-STUN</a>]</span>.<a href="#section-17.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-pvd">
<section id="section-17.6">
        <h3 id="name-new-provisioning-domain-add">
<a href="#section-17.6" class="section-number selfRef">17.6. </a><a href="#name-new-provisioning-domain-add" class="section-name selfRef">New Provisioning Domain Additional Information Key</a>
        </h3>
<p id="section-17.6-1">This document requests IANA to register a new JSON key in the
Provisioning Domains Additional Information registry at <span>[<a href="#IANA-PVD" class="cite xref">IANA-PVD</a>]</span>:<a href="#section-17.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-17.6-2">
<pre>
JSON key: cidfi
Description: CID Flow Indicator
Type: array of cidfi details
Example: ["cidfinode": "service.example.net", "cidfipathauth":
          "/authpath", "cidfimetadata": "/meta"]
</pre><a href="#section-17.6-2" class="pilcrow">¶</a>
</div>
<p id="section-17.6-3">Additionally, this document requests creating a new registry, entitled "CIDFI JSON Keys" under
the Provisioning Domains Additional Information registry group <span>[<a href="#IANA-PVD" class="cite xref">IANA-PVD</a>]</span>.
The policy for assigning new entries in this registry is Expert Review <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.
The structure of this registry is identical to the Provisioning Domains Additional Information registry group.
The initial content of this registry is provided below:<a href="#section-17.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-17.6-4">
<pre>
JSON key: cidfinode
Description: FQDN of CIDFI node
Type: string
Example: service.example.net

JSON key: min-ttl
Description: The minimum TTL or Hop Limit to reach a CNE
Type: Unsigned integer
Example: 5

JSON key: cidfipathauth
Description: authentication and authorization path for CIDFI
type: string
Example: "/authpath"

JSON key: cidfimetadata
Description: metadata path for CIDFI
type: string
example: "/metadata"
</pre><a href="#section-17.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-18">
      <h2 id="name-references">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-18.1">
        <h3 id="name-normative-references">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CBOR">[CBOR]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC">[QUIC]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2131">https://www.rfc-editor.org/rfc/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2474">https://www.rfc-editor.org/rfc/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2827">[RFC2827]</dt>
        <dd>
<span class="refAuthor">Ferguson, P.</span> and <span class="refAuthor">D. Senie</span>, <span class="refTitle">"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"</span>, <span class="seriesInfo">BCP 38</span>, <span class="seriesInfo">RFC 2827</span>, <span class="seriesInfo">DOI 10.17487/RFC2827</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2827">https://www.rfc-editor.org/rfc/rfc2827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4787">[RFC4787]</dt>
        <dd>
<span class="refAuthor">Audet, F., Ed.</span> and <span class="refAuthor">C. Jennings</span>, <span class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>, <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4787">https://www.rfc-editor.org/rfc/rfc4787</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6620">[RFC6620]</dt>
        <dd>
<span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Bagnulo, M.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"FCFS SAVI: First-Come, First-Served Source Address Validation Improvement for Locally Assigned IPv6 Addresses"</span>, <span class="seriesInfo">RFC 6620</span>, <span class="seriesInfo">DOI 10.17487/RFC6620</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6620">https://www.rfc-editor.org/rfc/rfc6620</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7513">[RFC7513]</dt>
        <dd>
<span class="refAuthor">Bi, J.</span>, <span class="refAuthor">Wu, J.</span>, <span class="refAuthor">Yao, G.</span>, and <span class="refAuthor">F. Baker</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Solution for DHCP"</span>, <span class="seriesInfo">RFC 7513</span>, <span class="seriesInfo">DOI 10.17487/RFC7513</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7513">https://www.rfc-editor.org/rfc/rfc7513</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
        <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8415">https://www.rfc-editor.org/rfc/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8801">[RFC8801]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span>, <span class="refAuthor">Vyncke, É.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Schinazi, D.</span>, and <span class="refAuthor">W. Shao</span>, <span class="refTitle">"Discovering Provisioning Domain Names and Data"</span>, <span class="seriesInfo">RFC 8801</span>, <span class="seriesInfo">DOI 10.17487/RFC8801</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8801">https://www.rfc-editor.org/rfc/rfc8801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9221">[RFC9221]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"An Unreliable Datagram Extension to QUIC"</span>, <span class="seriesInfo">RFC 9221</span>, <span class="seriesInfo">DOI 10.17487/RFC9221</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9221">https://www.rfc-editor.org/rfc/rfc9221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STUN">[STUN]</dt>
      <dd>
<span class="refAuthor">Petit-Huguenin, M.</span>, <span class="refAuthor">Salgueiro, G.</span>, <span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Mahy, R.</span>, and <span class="refAuthor">P. Matthews</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 8489</span>, <span class="seriesInfo">DOI 10.17487/RFC8489</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8489">https://www.rfc-editor.org/rfc/rfc8489</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-18.2">
        <h3 id="name-informative-references">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="cryptex">[cryptex]</dt>
        <dd>
<span class="refAuthor">Uberti, J.</span>, <span class="refAuthor">Jennings, C.</span>, and <span class="refAuthor">S. Murillo</span>, <span class="refTitle">"Completely Encrypting RTP Header Extensions and Contributing Sources"</span>, <span class="seriesInfo">RFC 9335</span>, <span class="seriesInfo">DOI 10.17487/RFC9335</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9335">https://www.rfc-editor.org/rfc/rfc9335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ECN">[ECN]</dt>
        <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3168">https://www.rfc-editor.org/rfc/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-avtcore-rtp-over-quic">[I-D.ietf-avtcore-rtp-over-quic]</dt>
        <dd>
<span class="refAuthor">Ott, J.</span>, <span class="refAuthor">Engelbart, M.</span>, and <span class="refAuthor">S. Dawkins</span>, <span class="refTitle">"RTP over QUIC (RoQ)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-avtcore-rtp-over-quic-07</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-avtcore-rtp-over-quic-07">https://datatracker.ietf.org/doc/html/draft-ietf-avtcore-rtp-over-quic-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-moq-requirements">[I-D.ietf-moq-requirements]</dt>
        <dd>
<span class="refAuthor">Gruessing, J.</span> and <span class="refAuthor">S. Dawkins</span>, <span class="refTitle">"Media Over QUIC - Use Cases and Requirements for Media Transport Protocol Design"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-moq-requirements-02</span>, <time datetime="2023-09-29" class="refDate">29 September 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-moq-requirements-02">https://datatracker.ietf.org/doc/html/draft-ietf-moq-requirements-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-load-balancers">[I-D.ietf-quic-load-balancers]</dt>
        <dd>
<span class="refAuthor">Duke, M.</span>, <span class="refAuthor">Banks, N.</span>, and <span class="refAuthor">C. Huitema</span>, <span class="refTitle">"QUIC-LB: Generating Routable QUIC Connection IDs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-load-balancers-17</span>, <time datetime="2023-08-15" class="refDate">15 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-load-balancers-17">https://datatracker.ietf.org/doc/html/draft-ietf-quic-load-balancers-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.joras-sadcdn">[I-D.joras-sadcdn]</dt>
        <dd>
<span class="refAuthor">Joras, M.</span>, <span class="refTitle">"Securing Ancillary Data for Communicating with Devices in the Network"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-joras-sadcdn-01</span>, <time datetime="2023-07-10" class="refDate">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-joras-sadcdn-01">https://datatracker.ietf.org/doc/html/draft-joras-sadcdn-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.zmlk-quic-te">[I-D.zmlk-quic-te]</dt>
        <dd>
<span class="refAuthor">Zheng, Z.</span>, <span class="refAuthor">Ma, Y.</span>, <span class="refAuthor">Liu, Y.</span>, and <span class="refAuthor">M. Kühlewind</span>, <span class="refTitle">"QUIC-enabled Service Differentiation for Traffic Engineering"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-zmlk-quic-te-01</span>, <time datetime="2023-11-08" class="refDate">8 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-zmlk-quic-te-01">https://datatracker.ietf.org/doc/html/draft-zmlk-quic-te-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-PVD">[IANA-PVD]</dt>
        <dd>
<span class="refTitle">"Provisioning Domains (PvDs)"</span>, <time datetime="2020-08-13" class="refDate">13 August 2020</time>, <span>&lt;<a href="https://www.iana.org/assignments/pvds/pvds.xhtml#additional-information-pvd-keys">https://www.iana.org/assignments/pvds/pvds.xhtml#additional-information-pvd-keys</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-QUIC">[IANA-QUIC]</dt>
        <dd>
<span class="refTitle">"QUIC"</span>, <time datetime="2023-07-26" class="refDate">26 July 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/quic/quic.xhtml">https://www.iana.org/assignments/quic/quic.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-STUN">[IANA-STUN]</dt>
        <dd>
<span class="refTitle">"STUN Attributes"</span>, <time datetime="2023-03-20" class="refDate">20 March 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/stun-parameters/stun-parameters.xhtml">https://www.iana.org/assignments/stun-parameters/stun-parameters.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-SVCB">[IANA-SVCB]</dt>
        <dd>
<span class="refTitle">"DNS Service Bindings (SVCB)"</span>, <time datetime="2023-06-13" class="refDate">13 June 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/dns-svcb/dns-svcb.xhtml">https://www.iana.org/assignments/dns-svcb/dns-svcb.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-WKU">[IANA-WKU]</dt>
        <dd>
<span class="refTitle">"Well-known URIs"</span>, <time datetime="2023-06-20" class="refDate">20 June 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml">https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NAPT">[NAPT]</dt>
        <dd>
<span class="refAuthor">Srisuresh, P.</span> and <span class="refAuthor">K. Egevang</span>, <span class="refTitle">"Traditional IP Network Address Translator (Traditional NAT)"</span>, <span class="seriesInfo">RFC 3022</span>, <span class="seriesInfo">DOI 10.17487/RFC3022</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3022">https://www.rfc-editor.org/rfc/rfc3022</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NAT">[NAT]</dt>
        <dd>
<span class="refAuthor">Srisuresh, P.</span> and <span class="refAuthor">M. Holdrege</span>, <span class="refTitle">"IP Network Address Translator (NAT) Terminology and Considerations"</span>, <span class="seriesInfo">RFC 2663</span>, <span class="seriesInfo">DOI 10.17487/RFC2663</span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2663">https://www.rfc-editor.org/rfc/rfc2663</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="pathologies">[pathologies]</dt>
        <dd>
<span class="refAuthor">Custura, A.</span>, <span class="refAuthor">Secchi, R.</span>, and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"Exploring DSCP modification pathologies in the Internet"</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.sciencedirect.com/science/article/pii/S0140366417312835">https://www.sciencedirect.com/science/article/pii/S0140366417312835</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6105">[RFC6105]</dt>
        <dd>
<span class="refAuthor">Levy-Abegnoli, E.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Popoviciu, C.</span>, and <span class="refAuthor">J. Mohacsi</span>, <span class="refTitle">"IPv6 Router Advertisement Guard"</span>, <span class="seriesInfo">RFC 6105</span>, <span class="seriesInfo">DOI 10.17487/RFC6105</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6105">https://www.rfc-editor.org/rfc/rfc6105</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7839">[RFC7839]</dt>
        <dd>
<span class="refAuthor">Bhandari, S.</span>, <span class="refAuthor">Gundavelli, S.</span>, <span class="refAuthor">Grayson, M.</span>, <span class="refAuthor">Volz, B.</span>, and <span class="refAuthor">J. Korhonen</span>, <span class="refTitle">"Access-Network-Identifier Option in DHCP"</span>, <span class="seriesInfo">RFC 7839</span>, <span class="seriesInfo">DOI 10.17487/RFC7839</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7839">https://www.rfc-editor.org/rfc/rfc7839</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8517">[RFC8517]</dt>
        <dd>
<span class="refAuthor">Dolson, D., Ed.</span>, <span class="refAuthor">Snellman, J.</span>, <span class="refAuthor">Boucadair, M., Ed.</span>, and <span class="refAuthor">C. Jacquenet</span>, <span class="refTitle">"An Inventory of Transport-Centric Functions Provided by Middleboxes: An Operator Perspective"</span>, <span class="seriesInfo">RFC 8517</span>, <span class="seriesInfo">DOI 10.17487/RFC8517</span>, <time datetime="2019-02" class="refDate">February 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8517">https://www.rfc-editor.org/rfc/rfc8517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9146">[RFC9146]</dt>
        <dd>
<span class="refAuthor">Rescorla, E., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifier for DTLS 1.2"</span>, <span class="seriesInfo">RFC 9146</span>, <span class="seriesInfo">DOI 10.17487/RFC9146</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9146">https://www.rfc-editor.org/rfc/rfc9146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RTP">[RTP]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Casner, S.</span>, <span class="refAuthor">Frederick, R.</span>, and <span class="refAuthor">V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">STD 64</span>, <span class="seriesInfo">RFC 3550</span>, <span class="seriesInfo">DOI 10.17487/RFC3550</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3550">https://www.rfc-editor.org/rfc/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTP">[SRTP]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Naslund, M.</span>, <span class="refAuthor">Carrara, E.</span>, and <span class="refAuthor">K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time datetime="2004-03" class="refDate">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3711">https://www.rfc-editor.org/rfc/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="wifi-aggregation">[wifi-aggregation]</dt>
      <dd>
<span class="refAuthor">Høiland-Jørgensen, T.</span>, <span class="refAuthor">Kazior, M.</span>, <span class="refAuthor">Täht, D.</span>, <span class="refAuthor">Hurtig, P.</span>, and <span class="refAuthor">A. Brunstrom</span>, <span class="refTitle">"Ending the Anomaly: Achieving Low Latency and Airtime Fairness in WiFi"</span>, <time datetime="2017-05-22" class="refDate">22 May 2017</time>, <span>&lt;<a href="https://www.usenix.org/conference/atc17/technical-sessions/presentation/hoilan-jorgesen">https://www.usenix.org/conference/atc17/technical-sessions/presentation/hoilan-jorgesen</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="extending">
<section id="appendix-A">
      <h2 id="name-extending-cidfi-to-other-pr">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-extending-cidfi-to-other-pr" class="section-name selfRef">Extending CIDFI to Other Protocols</a>
      </h2>
<p id="appendix-A-1">CIDFI can be extended to other protocols including TCP, SCTP, RTP, and SRTP,
and bespoke UDP protocols.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">An extension to each protocol is described below which retains the
ability of the client to prove its ownership of the 5-tuple to a CNE.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="dtls">
<section id="appendix-A.1">
        <h3 id="name-dtls">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-dtls" class="section-name selfRef">DTLS</a>
        </h3>
<p id="appendix-A.1-1">DTLS is used by WebRTC and SIP for establishing interactive real-time audio,
video, and screen sharing, which benefit from knowing network characteristics
(n2h signaling) and benefit from prioritizing audio over video (h2n signaling).
<span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> defines an extension to add a Connection ID (CID) to the
DTLS record layer. DTLS CID can be leveraged by CIDFI to communicate
per-connection information from endpoint to CNE and vice-versa.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcp">
<section id="appendix-A.2">
        <h3 id="name-tcp">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-tcp" class="section-name selfRef">TCP</a>
        </h3>
<p id="appendix-A.2-1">To prove ownership of the TCP 4-tuple, TCP can utilize a new TCP
option to carry the CNE's nonce and HMAC-output.  This TCP option can be carried
in both the TCP SYN and in some subsequent packets to avoid consuming the entire
TCP option space (40 bytes).  Sub-options can be defined to carry pieces of
the Nonce and HMAC output, with the first piece of the Nonce in the TCP SYN
so the CIDFI network element can be triggered to begin looking for the subsequent
TCP frames containing the rest of the CIDFI nonce and CIDFI HMAC-output.  For example,<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2-2">
<li id="appendix-A.2-2.1">
            <p id="appendix-A.2-2.1.1">send TCP SYN + CIDFI option (including Nonce bits 0-63)<a href="#appendix-A.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.2">
            <p id="appendix-A.2-2.2.1">if received TCP SYNACK does not indicate CIDFI support, stop sending CIDFI option<a href="#appendix-A.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.3">
            <p id="appendix-A.2-2.3.1">send next TCP packet + CIDFI option (including Nonce bytes 64-128)<a href="#appendix-A.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.4">
            <p id="appendix-A.2-2.4.1">send next TCP packet + CIDFI option (including HMAC-output bits 0-127)<a href="#appendix-A.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.5">
            <p id="appendix-A.2-2.5.1">send next TCP packet + CIDFI option (including HMAC-output bytes 128-256)<a href="#appendix-A.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-A.2-3">To shorten this further we might truncate the HMAC output and/or
truncate the Nonce after security evaluation.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp">
<section id="appendix-A.3">
        <h3 id="name-sctp">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-sctp" class="section-name selfRef">SCTP</a>
        </h3>
<p id="appendix-A.3-1">If SCTP is sent directly over IP, proof of ownership of the
SCTP 4-tuple can be achieved using an extension to its INIT
packets, similar to what is described above for TCP SYN.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">If SCTP is run over UDP, the same proof of ownership of the UDP
4-tuple as described in <a href="#ownership" class="auto internal xref">Section 7.2</a> can be performed.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rtp-and-srtp">
<section id="appendix-A.4">
        <h3 id="name-rtp-and-srtp">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-rtp-and-srtp" class="section-name selfRef">RTP and SRTP</a>
        </h3>
<p id="appendix-A.4-1">The RTP Synchronization Source (SSRC) is in the clear for <span>[<a href="#RTP" class="cite xref">RTP</a>]</span>, <span>[<a href="#SRTP" class="cite xref">SRTP</a>]</span>,
and <span>[<a href="#cryptex" class="cite xref">cryptex</a>]</span>.  If the SSRC is signaled similarly to CID, RTP could also
benefit from CIDFI.  CIDFI network elements could be told the mapping of SSRC values to
importance and schedule those SSRCs accordingly.  However, SSRC is used in playout (jitter)
buffers and a new SSRC seen by a receiver will cause confusion.  Thus, overloading SSRC
to mean both 'packet importance' for CIDFI and 'synchronization source' will require
engineering work on the RTP receiver to treat all the signaled SSRCs as one source for
purposes of its playout buffer.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">RTP over QUIC <span>[<a href="#I-D.ietf-avtcore-rtp-over-quic" class="cite xref">I-D.ietf-avtcore-rtp-over-quic</a>]</span> is another approach which exposes
QUIC headers to the network (which have CIDs) and does not overload the RTP SSRC.  The
Media over QUIC (MOQ) working group includes RTP over QUIC as one of its use cases
<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-moq-requirements-02#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-moq-requirements" class="cite xref">I-D.ietf-moq-requirements</a>]</span>.<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bespoke-udp-application-protocols">
<section id="appendix-A.5">
        <h3 id="name-bespoke-udp-application-pro">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-bespoke-udp-application-pro" class="section-name selfRef">Bespoke UDP Application Protocols</a>
        </h3>
<p id="appendix-A.5-1">To work with CIDFI, other UDP application protocols would have to
prove ownership of their UDP 4-tuple (<a href="#ownership" class="auto internal xref">Section 7.2</a>) and extend their
protocol to include a connection identifier in the first several bits
of each of their UDP packets.<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.5-2">Alternatively, rather than modifying the application protocol it could be run
over <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#appendix-A.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">Thanks to Dave Täht, Magnus Westerlund, Christian Huitema, Gorry Fairhurst,
and Tom Herbert for hallway discussions and feedback at TSVWG that encouraged
the authors to consider the approach described in this document.  Thanks to
Ben Schwartz for suggesting PvD as an alternative discovery mechanism.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Cloud Software Group Holdings, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:danwing@gmail.com" class="email">danwing@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left"><span class="street-address">Rennes</span></div>
<div dir="auto" class="left">
<span class="postal-code">35000</span> </div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohamed.boucadair@orange.com" class="email">mohamed.boucadair@orange.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
